// Datastar v1.0.0
// This bundle was licensed to Github user 'delaneyj'
// 1c046185dd3664617e0816f93599e6f6
var Be=/ðŸ–•JS_DSðŸš€/.source,Me=Be.slice(0,5),Le=Be.slice(4),V="datastar-fetch",ce="datastar-signal-patch";var Fe=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([a-z])([0-9]+)/gi,"$1-$2").replace(/([0-9]+)([a-z])/gi,"$1-$2").replace(/[\s_]+/g,"-").toLowerCase();var Ke=e=>Fe(e).replace(/-/g,"_");var ze={camel:e=>e.replace(/-[a-z]/g,n=>n[1].toUpperCase()),snake:e=>e.replace(/-/g,"_"),pascal:e=>e[0].toUpperCase()+ze.camel(e.slice(1))},le=(e,n,t="camel")=>{for(let s of n.get("case")||[t])e=ze[s]?.(e)||e;return e},k=e=>`data-${e}`;var L=Object.hasOwn??Object.prototype.hasOwnProperty.call;var Z=e=>e!==null&&typeof e=="object"&&(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null);var fe=e=>{let n={};for(let[t,s]of e){let r=t.split("."),i=r.pop(),a=r.reduce((o,c)=>o[c]??={},n);a[i]=s}return n};var de=[],Ne=[],ye=0,ue=0,Ce=0,He,N,pe=0,q=()=>{ye++},G=()=>{--ye||(Ze(),_())},ve=e=>{He=N,N=e},be=()=>{N=He,He=void 0},Y=e=>Nt.bind(0,{previousValue:e,t:e,e:1}),Oe=Symbol("computed"),Ft=e=>{let n=Ct.bind(0,{e:17,getter:e});return n[Oe]=1,n},Pe=e=>{let n={u:e,e:2};N&&_e(n,N),ve(n),q();try{n.u()}finally{G(),be()}return tt.bind(0,n)},Ze=()=>{for(;ue<Ce;){let e=Ne[ue];Ne[ue++]=void 0,et(e,e.e&=-65)}ue=0,Ce=0},Je=e=>"getter"in e?Ye(e):Xe(e,e.t),Ye=e=>{ve(e),nt(e);try{let n=e.t;return n!==(e.t=e.getter(n))}finally{be(),st(e)}},Xe=(e,n)=>(e.e=1,e.previousValue!==(e.previousValue=n)),ke=e=>{let n=e.e;if(!(n&64)){e.e=n|64;let t=e.s;t?ke(t.a):Ne[Ce++]=e}},et=(e,n)=>{if(n&16||n&32&&rt(e.r,e)){ve(e),nt(e),q();try{e.u()}finally{G(),be(),st(e)}return}n&32&&(e.e=n&-33);let t=e.r;for(;t;){let s=t.c,r=s.e;r&64&&et(s,s.e=r&-65),t=t.i}},Nt=(e,...n)=>{if(n.length){if(e.t!==(e.t=n[0])){e.e=17;let s=e.s;return s&&(Ht(s),ye||Ze()),!0}return!1}let t=e.t;if(e.e&16&&Xe(e,t)){let s=e.s;s&&he(s)}return N&&_e(e,N),t},Ct=e=>{let n=e.e;if(n&16||n&32&&rt(e.r,e)){if(Ye(e)){let t=e.s;t&&he(t)}}else n&32&&(e.e=n&-33);return N&&_e(e,N),e.t},tt=e=>{let n=e.r;for(;n;)n=me(n,e);let t=e.s;t&&me(t),e.e=0},_e=(e,n)=>{let t=n.o;if(t&&t.c===e)return;let s=t?t.i:n.r;if(s&&s.c===e){s.p=pe,n.o=s;return}let r=e.g;if(r&&r.p===pe&&r.a===n)return;let i=n.o=e.g={p:pe,c:e,a:n,l:t,i:s,f:r};s&&(s.l=i),t?t.i=i:n.r=i,r?r.n=i:e.s=i},me=(e,n=e.a)=>{let t=e.c,s=e.l,r=e.i,i=e.n,a=e.f;if(r?r.l=s:n.o=s,s?s.i=r:n.r=r,i?i.f=a:t.g=a,a)a.n=i;else if(!(t.s=i))if("getter"in t){let o=t.r;if(o){t.e=17;do o=me(o,t);while(o)}}else"previousValue"in t||tt(t);return r},Ht=e=>{let n=e.n,t;e:for(;;){let s=e.a,r=s.e;if(r&60?r&12?r&4?!(r&48)&&Ot(e,s)?(s.e=r|40,r&=1):r=0:s.e=r&-9|32:r=0:s.e=r|32,r&2&&ke(s),r&1){let i=s.s;if(i){let a=(e=i).n;a&&(t={t:n,d:t},n=a);continue}}if(e=n){n=e.n;continue}for(;t;)if(e=t.t,t=t.d,e){n=e.n;continue e}break}},nt=e=>{pe++,e.o=void 0,e.e=e.e&-57|4},st=e=>{let n=e.o,t=n?n.i:e.r;for(;t;)t=me(t,e);e.e&=-5},rt=(e,n)=>{let t,s=0,r=!1;e:for(;;){let i=e.c,a=i.e;if(n.e&16)r=!0;else if((a&17)===17){if(Je(i)){let o=i.s;o.n&&he(o),r=!0}}else if((a&33)===33){(e.n||e.f)&&(t={t:e,d:t}),e=i.r,n=i,++s;continue}if(!r){let o=e.i;if(o){e=o;continue}}for(;s--;){let o=n.s,c=o.n;if(c?(e=t.t,t=t.d):e=o,r){if(Je(n)){c&&he(o),n=e.a;continue}r=!1}else n.e&=-33;if(n=e.a,e.i){e=e.i;continue e}}return r}},he=e=>{do{let n=e.a,t=n.e;(t&48)===32&&(n.e=t|16,t&2&&ke(n))}while(e=e.n)},Ot=(e,n)=>{let t=n.o;for(;t;){if(t===e)return!0;t=t.l}return!1},W=e=>{let n=D,t=e.split(".");for(let s of t){if(n==null||!L(n,s))return;n=n[s]}return n},ge=(e,n="")=>{let t=Array.isArray(e);if(t||Z(e)){let s=t?[]:{};for(let i in e)s[i]=Y(ge(e[i],`${n+i}.`));let r=Y(0);return new Proxy(s,{get(i,a){if(!(a==="toJSON"&&!L(s,a)))return t&&a in Array.prototype?(r(),s[a]):typeof a=="symbol"?s[a]:((!L(s,a)||s[a]()==null)&&(s[a]=Y(""),_(n+a,""),r(r()+1)),s[a]())},set(i,a,o){let c=n+a;if(t&&a==="length"){let l=s[a]-o;if(s[a]=o,l>0){let f={};for(let p=o;p<s[a];p++)f[p]=null;_(n.slice(0,-1),f),r(r()+1)}}else L(s,a)?o==null?delete s[a]:L(o,Oe)?(s[a]=o,_(c,"")):s[a](ge(o,`${c}.`))&&_(c,o):o!=null&&(L(o,Oe)?(s[a]=o,_(c,"")):(s[a]=Y(ge(o,`${c}.`)),_(c,o)),r(r()+1));return!0},deleteProperty(i,a){return delete s[a],r(r()+1),!0},ownKeys(){return r(),Reflect.ownKeys(s)},has(i,a){return r(),a in s}})}return e},_=(e,n)=>{if(e!==void 0&&n!==void 0&&de.push([e,n]),!ye&&de.length){let t=fe(de);de.length=0,document.dispatchEvent(new CustomEvent(ce,{detail:t}))}},it=(e,{ifMissing:n}={})=>{q();for(let t in e)e[t]==null?n||delete D[t]:at(e[t],t,D,"",n);G()},j=(e,n)=>it(fe(e),n),at=(e,n,t,s,r)=>{if(Z(e)){L(t,n)&&(Z(t[n])||Array.isArray(t[n]))||(t[n]={});for(let i in e)e[i]==null?r||delete t[n][i]:at(e[i],i,t[n],`${s+n}.`,r)}else r&&L(t,n)||(t[n]=e)},Qe=e=>typeof e=="string"?RegExp(e.replace(/^\/|\/$/g,"")):e,De=({include:e=/.*/,exclude:n=/(?!)/}={},t=D)=>{let s=Qe(e),r=Qe(n),i=[],a=[[t,""]];for(;a.length;){let[o,c]=a.pop();for(let l in o){let f=c+l;Z(o[l])?a.push([o[l],`${f}.`]):s.test(f)&&!r.test(f)&&i.push([f,W(f)])}}return fe(i)},D=ge({});var O=e=>e instanceof HTMLElement||e instanceof SVGElement||e instanceof MathMLElement;var Pt="https://data-star.dev/errors",X=(e,n,t={})=>{Object.assign(t,e);let s=new Error,r=Ke(n),i=new URLSearchParams({metadata:JSON.stringify(t)}).toString(),a=JSON.stringify(t,null,2);return s.message=`${n}
More info: ${Pt}/${r}?${i}
Context: ${a}`,s},Se=new Map,ct=new Map,lt=new Map,ft=new Proxy({},{get:(e,n)=>Se.get(n)?.apply,has:(e,n)=>Se.has(n),ownKeys:()=>Reflect.ownKeys(Se),set:()=>!1,deleteProperty:()=>!1}),ee=new Map,Ee=[],$e=new Set,te=e=>{Ee.push(e),Ee.length===1&&setTimeout(()=>{for(let n of Ee)$e.add(n.name),ct.set(n.name,n);Ee.length=0,$t(),$e.clear()})},U=e=>{Se.set(e.name,e)};document.addEventListener(V,e=>{let n=lt.get(e.detail.type);n&&n.apply({error:X.bind(0,{plugin:{type:"watcher",name:n.name},element:{id:e.target.id,tag:e.target.tagName}})},e.detail.argsRaw)});var Ie=e=>{lt.set(e.name,e)},ot=e=>{for(let n of e){let t=ee.get(n);if(ee.delete(n)){for(let s of t.values())s();t.clear()}}},dt=k("ignore"),kt=`[${dt}]`,ut=e=>e.hasAttribute(`${dt}__self`)||!!e.closest(kt),Te=(e,n)=>{for(let t of e)if(!ut(t))for(let s in t.dataset)pt(t,s.replace(/[A-Z]/g,"-$&").toLowerCase(),t.dataset[s],n)},_t=e=>{for(let{target:n,type:t,attributeName:s,addedNodes:r,removedNodes:i}of e)if(t==="childList"){for(let a of i)O(a)&&(ot([a]),ot(a.querySelectorAll("*")));for(let a of r)O(a)&&(Te([a]),Te(a.querySelectorAll("*")))}else if(t==="attributes"&&s.startsWith("data-")&&O(n)&&!ut(n)){let a=s.slice(5),o=n.getAttribute(s);if(o===null){let c=ee.get(n);c&&(c.get(a)?.(),c.delete(a))}else pt(n,a,o)}},Dt=new MutationObserver(_t),$t=(e=document.documentElement)=>{O(e)&&Te([e],!0),Te(e.querySelectorAll("*"),!0),Dt.observe(e,{subtree:!0,childList:!0,attributes:!0})},pt=(e,n,t,s)=>{{let r=n,[i,...a]=r.split("__"),[o,c]=i.split(/:(.+)/),l=ct.get(o);if((!s||$e.has(o))&&l){let f={el:e,rawKey:r,mods:new Map,error:X.bind(0,{plugin:{type:"attribute",name:l.name},element:{id:e.id,tag:e.tagName},expression:{rawKey:r,key:c,value:t}}),key:c,value:t,rx:void 0},p=l.requirement&&(typeof l.requirement=="string"?l.requirement:l.requirement.key)||"allowed",S=l.requirement&&(typeof l.requirement=="string"?l.requirement:l.requirement.value)||"allowed";if(c){if(p==="denied")throw f.error("KeyNotAllowed")}else if(p==="must")throw f.error("KeyRequired");if(t){if(S==="denied")throw f.error("ValueNotAllowed")}else if(S==="must")throw f.error("ValueRequired");if(p==="exclusive"||S==="exclusive"){if(c&&t)throw f.error("KeyAndValueProvided");if(!c&&!t)throw f.error("KeyOrValueRequired")}if(t){let u;f.rx=(...m)=>(u||(u=It(t,{returnsValue:l.returnsValue,argNames:l.argNames})),u(e,...m))}for(let u of a){let[m,...y]=u.split(".");f.mods.set(m,new Set(y))}let d=l.apply(f);if(d){let u=ee.get(e);u?u.get(r)?.():(u=new Map,ee.set(e,u)),u.set(r,d)}}}},It=(e,{returnsValue:n=!1,argNames:t=[]}={})=>{let s="";if(n){let o=/(\/(\\\/|[^/])*\/|"(\\"|[^"])*"|'(\\'|[^'])*'|`(\\`|[^`])*`|\(\s*((function)\s*\(\s*\)|(\(\s*\))\s*=>)\s*(?:\{[\s\S]*?\}|[^;){]*)\s*\)\s*\(\s*\)|[^;])+/gm,c=e.trim().match(o);if(c){let l=c.length-1,f=c[l].trim();f.startsWith("return")||(c[l]=`return (${f});`),s=c.join(`;
`)}}else s=e.trim();let r=new Map,i=RegExp(`(?:${Me})(.*?)(?:${Le})`,"gm"),a=0;for(let o of s.matchAll(i)){let c=o[1],l=`__escaped${a++}`;r.set(l,c),s=s.replace(Me+c+Le,l)}s=s.replace(/\$\['([a-zA-Z_$\d][\w$]*)'\]/g,"$$$1").replace(/\$([a-zA-Z_\d]\w*(?:[.-]\w+)*)/g,(o,c)=>c.split(".").reduce((l,f)=>`${l}['${f}']`,"$")).replace(/\[(\$[a-zA-Z_\d]\w*)\]/g,(o,c)=>`[$['${c.slice(1)}']]`),s=s.replaceAll(/@(\w+)\(/g,'__action("$1",evt,');for(let[o,c]of r)s=s.replace(o,c);try{let o=Function("el","$","__action","evt",...t,s);return(c,...l)=>{let f=(p,S,...d)=>{let u=X.bind(0,{plugin:{type:"action",name:p},element:{id:c.id,tag:c.tagName},expression:{fnContent:s,value:e}}),m=ft[p];if(m)return m({el:c,evt:S,error:u},...d);throw u("UndefinedAction")};try{return o(c,D,f,void 0,...l)}catch(p){throw console.error(p),X({element:{id:c.id,tag:c.tagName},expression:{fnContent:s,value:e},error:p.message},"ExecuteExpression")}}}catch(o){throw console.error(o),X({expression:{fnContent:s,value:e},error:o.message},"GenerateExpression")}};var w=new Map,K=new Set,B=new Map,ne=new Set,z=document.createElement("div");z.hidden=!0;var se=k("ignore-morph"),Vt=`[${se}]`,Ge=(e,n,t="outer")=>{if(O(e)&&O(n)&&e.hasAttribute(se)&&n.hasAttribute(se)||e.parentElement?.closest(Vt))return;let s=document.createElement("div");s.append(n),document.body.insertAdjacentElement("afterend",z);let r=e.querySelectorAll("[id]");for(let{id:o,tagName:c}of r)B.has(o)?ne.add(o):B.set(o,c);e instanceof Element&&e.id&&(B.has(e.id)?ne.add(e.id):B.set(e.id,e.tagName)),K.clear();let i=s.querySelectorAll("[id]");for(let{id:o,tagName:c}of i)K.has(o)?ne.add(o):B.get(o)===c&&K.add(o);for(let o of ne)K.delete(o);B.clear(),ne.clear(),w.clear();let a=t==="outer"?e.parentElement:e;mt(a,r),mt(s,i),ht(a,s,t==="outer"?e:null,e.nextSibling),z.remove()},ht=(e,n,t=null,s=null)=>{e instanceof HTMLTemplateElement&&n instanceof HTMLTemplateElement&&(e=e.content,n=n.content),t??=e.firstChild;for(let r of n.childNodes){if(t&&t!==s){let i=qt(r,t,s);if(i){if(i!==t){let a=t;for(;a&&a!==i;){let o=a;a=a.nextSibling,qe(o)}}Ve(i,r),t=i.nextSibling;continue}}if(r instanceof Element&&K.has(r.id)){let i=document.getElementById(r.id),a=i;for(;a=a.parentNode;){let o=w.get(a);o&&(o.delete(r.id),o.size||w.delete(a))}yt(e,i,t),Ve(i,r),t=i.nextSibling;continue}if(w.has(r)){let i=document.createElement(r.tagName);e.insertBefore(i,t),Ve(i,r),t=i.nextSibling}else{let i=document.importNode(r,!0);e.insertBefore(i,t),t=i.nextSibling}}for(;t&&t!==s;){let r=t;t=t.nextSibling,qe(r)}},qt=(e,n,t)=>{let s=null,r=e.nextSibling,i=0,a=0,o=w.get(e)?.size||0,c=n;for(;c&&c!==t;){if(gt(c,e)){let l=!1,f=w.get(c),p=w.get(e);if(p&&f){for(let S of f)if(p.has(S)){l=!0;break}}if(l)return c;if(!s&&!w.has(c)){if(!o)return c;s=c}}if(a+=w.get(c)?.size||0,a>o)break;s===null&&r&&gt(c,r)&&(i++,r=r.nextSibling,i>=2&&(s=void 0)),c=c.nextSibling}return s||null},gt=(e,n)=>e.nodeType===n.nodeType&&e.tagName===n.tagName&&(!e.id||e.id===n.id),qe=e=>{w.has(e)?yt(z,e,null):e.parentNode?.removeChild(e)},yt=qe.call.bind(z.moveBefore??z.insertBefore),Gt=k("preserve-attr"),Ve=(e,n)=>{let t=n.nodeType;if(t===1){let s=e,r=n;if(s.hasAttribute(se)&&r.hasAttribute(se))return e;s instanceof HTMLInputElement&&r instanceof HTMLInputElement&&r.type!=="file"?r.getAttribute("value")!==s.getAttribute("value")&&(s.value=r.getAttribute("value")??""):s instanceof HTMLTextAreaElement&&r instanceof HTMLTextAreaElement&&(r.value!==s.value&&(s.value=r.value),s.firstChild&&s.firstChild.nodeValue!==r.value&&(s.firstChild.nodeValue=r.value));let i=(n.getAttribute(Gt)??"").split(" ");for(let{name:a,value:o}of r.attributes)s.getAttribute(a)!==o&&!i.includes(a)&&s.setAttribute(a,o);for(let a=s.attributes.length-1;a>=0;a--){let{name:o}=s.attributes[a];!r.hasAttribute(o)&&!i.includes(o)&&s.removeAttribute(o)}s.isEqualNode(r)||ht(s,r)}return(t===8||t===3)&&e.nodeValue!==n.nodeValue&&(e.nodeValue=n.nodeValue),e},mt=(e,n)=>{for(let t of n)if(K.has(t.id)){let s=t;for(;s&&s!==e;){let r=w.get(s);r||(r=new Set,w.set(s,r)),r.add(t.id),s=s.parentElement}}};var Re=new WeakMap,re=(e,n)=>U({name:e,apply:async({el:t,evt:s,error:r},i,{selector:a,headers:o,contentType:c="json",filterSignals:{include:l=/.*/,exclude:f=/(^|\.)_/}={},openWhenHidden:p=!1,retryInterval:S=1e3,retryScaler:d=2,retryMaxWaitMs:u=3e4,retryMaxCount:m=10,requestCancellation:y="auto"}={})=>{let T=y instanceof AbortController?y:new AbortController,E=y==="disabled";if(!E){let b=Re.get(t);b&&(b.abort(),await Promise.resolve())}!E&&!(y instanceof AbortController)&&Re.set(t,T);try{let b=new MutationObserver(C=>{for(let x of C)for(let H of x.removedNodes)H===t&&(T.abort(),P())});t.parentNode&&b.observe(t.parentNode,{childList:!0});let P=()=>{b.disconnect()};try{if(!i?.length)throw r("FetchNoUrlProvided",{action:U});let C={Accept:"text/event-stream, text/html, application/json","Datastar-Request":!0};c==="json"&&(C["Content-Type"]="application/json");let x=Object.assign({},C,o),H={method:n,headers:x,openWhenHidden:p,retryInterval:S,retryScaler:d,retryMaxWaitMs:u,retryMaxCount:m,signal:T.signal,onopen:async g=>{g.status>=400&&$(Ut,t,{status:g.status.toString()})},onmessage:g=>{if(!g.event.startsWith("datastar"))return;let F=g.event,v={};for(let A of g.data.split(`
`)){let h=A.indexOf(" "),M=A.slice(0,h),Q=A.slice(h+1);(v[M]||=[]).push(Q)}let R=Object.fromEntries(Object.entries(v).map(([A,h])=>[A,h.join(`
`)]));$(F,t,R)},onerror:g=>{if(vt(g))throw g("FetchExpectedTextEventStream",{url:i});g&&(console.error(g.message),$(Bt,t,{message:g.message}))}},J=new URL(i,document.baseURI),I=new URLSearchParams(J.search);if(c==="json"){let g=JSON.stringify(De({include:l,exclude:f}));n==="GET"?I.set("datastar",g):H.body=g}else if(c==="form"){let g=a?document.querySelector(a):t.closest("form");if(!g)throw r("FetchFormNotFound",{action:U,selector:a});if(!g.checkValidity()){g.reportValidity(),P();return}let F=new FormData(g),v=t;if(t===g&&s instanceof SubmitEvent)v=s.submitter;else{let h=M=>M.preventDefault();g.addEventListener("submit",h),P=()=>{g.removeEventListener("submit",h),b.disconnect()}}if(v instanceof HTMLButtonElement){let h=v.getAttribute("name");h&&F.append(h,v.value)}let R=g.getAttribute("enctype")==="multipart/form-data";R||(x["Content-Type"]="application/x-www-form-urlencoded");let A=new URLSearchParams(F);if(n==="GET")for(let[h,M]of A)I.append(h,M);else R?H.body=F:H.body=A}else throw r("FetchInvalidContentType",{action:U,contentType:c});$(Wt,t,{}),J.search=I.toString();try{await Yt(J.toString(),t,H)}catch(g){if(!vt(g))throw r("FetchFailed",{method:n,url:i,error:g.message})}}finally{$(jt,t,{}),P()}}finally{Re.get(t)===T&&Re.delete(t)}}});re("delete","DELETE");re("get","GET");re("patch","PATCH");re("post","POST");re("put","PUT");var Wt="started",jt="finished",Ut="error",Bt="retrying",Kt="retries-failed",$=(e,n,t)=>document.dispatchEvent(new CustomEvent(V,{detail:{type:e,el:n,argsRaw:t}})),vt=e=>`${e}`.includes("text/event-stream"),zt=async(e,n)=>{let t=e.getReader(),s=await t.read();for(;!s.done;)n(s.value),s=await t.read()},Jt=e=>{let n,t,s,r=!1;return i=>{n?n=Zt(n,i):(n=i,t=0,s=-1);let a=n.length,o=0;for(;t<a;){r&&(n[t]===10&&(o=++t),r=!1);let c=-1;for(;t<a&&c===-1;++t)switch(n[t]){case 58:s===-1&&(s=t-o);break;case 13:r=!0;case 10:c=t;break}if(c===-1)break;e(n.subarray(o,c),s),o=t,s=-1}o===a?n=void 0:o&&(n=n.subarray(o),t-=o)}},Qt=(e,n,t)=>{let s=bt(),r=new TextDecoder;return(i,a)=>{if(!i.length)t?.(s),s=bt();else if(a>0){let o=r.decode(i.subarray(0,a)),c=a+(i[a+1]===32?2:1),l=r.decode(i.subarray(c));switch(o){case"data":s.data=s.data?`${s.data}
${l}`:l;break;case"event":s.event=l;break;case"id":e(s.id=l);break;case"retry":{let f=+l;Number.isNaN(f)||n(s.retry=f);break}}}}},Zt=(e,n)=>{let t=new Uint8Array(e.length+n.length);return t.set(e),t.set(n,e.length),t},bt=()=>({data:"",event:"",id:"",retry:void 0}),Yt=(e,n,{signal:t,headers:s,onopen:r,onmessage:i,onclose:a,onerror:o,openWhenHidden:c,fetch:l,retryInterval:f=1e3,retryScaler:p=2,retryMaxWaitMs:S=3e4,retryMaxCount:d=10,overrides:u,...m})=>new Promise((y,T)=>{let E={...s},b,P=()=>{b.abort(),document.hidden||F()};c||document.addEventListener("visibilitychange",P);let C=0,x=()=>{document.removeEventListener("visibilitychange",P),window.clearTimeout(C),b.abort()};t?.addEventListener("abort",()=>{x(),y()});let H=l||window.fetch,J=r||(()=>{}),I=0,g=f,F=async()=>{b=new AbortController;try{let v=await H(e,{...m,headers:E,signal:b.signal});I=0,f=g,await J(v);let R=async(h,M,Q,ae,...Lt)=>{let Ue={[Q]:await M.text()};for(let we of Lt){let xe=M.headers.get(`datastar-${Fe(we)}`);if(ae){let oe=ae[we];oe&&(xe=typeof oe=="string"?oe:JSON.stringify(oe))}xe&&(Ue[we]=xe)}$(h,n,Ue),x(),y()},A=v.headers.get("Content-Type");if(A?.includes("text/html"))return await R("datastar-patch-elements",v,"elements",u,"selector","mode","useViewTransition");if(A?.includes("application/json"))return await R("datastar-patch-signals",v,"signals",u,"onlyIfMissing");if(A?.includes("text/javascript")){let h=document.createElement("script"),M=v.headers.get("datastar-script-attributes");if(M)for(let[Q,ae]of Object.entries(JSON.parse(M)))h.setAttribute(Q,ae);h.textContent=await v.text(),document.head.appendChild(h),x();return}await zt(v.body,Jt(Qt(h=>{h?E["last-event-id"]=h:delete E["last-event-id"]},h=>{g=f=h},i))),a?.(),x(),y()}catch(v){if(!b.signal.aborted)try{let R=o?.(v)||f;window.clearTimeout(C),C=window.setTimeout(F,R),f=Math.min(f*p,S),++I>=d?($(Kt,n,{}),x(),T("Max retries reached.")):console.error(`Datastar failed to reach ${e.toString()} retrying in ${R}ms.`)}catch(R){x(),T(R)}}};F()});var Xt=/^data:(?<mime>[^;]+);base64,(?<contents>.*)$/,Et=Symbol("empty"),St=k("bind");te({name:"bind",requirement:"exclusive",apply({el:e,key:n,mods:t,value:s,error:r}){let i=n!=null?le(n,t):s,a=(d,u)=>u==="number"?+d.value:d.value,o=d=>{e.value=`${d}`};if(e instanceof HTMLInputElement)switch(e.type){case"range":case"number":a=(d,u)=>u==="string"?d.value:+d.value;break;case"checkbox":a=(d,u)=>d.value!=="on"?u==="boolean"?d.checked:d.checked?d.value:"":u==="string"?d.checked?d.value:"":d.checked,o=d=>{e.checked=typeof d=="string"?d===e.value:d};break;case"radio":e.getAttribute("name")?.length||e.setAttribute("name",i),a=(d,u)=>d.checked?u==="number"?+d.value:d.value:Et,o=d=>{e.checked=d===(typeof d=="number"?+e.value:e.value)};break;case"file":{let d=()=>{let u=[...e.files||[]],m=[];Promise.all(u.map(y=>new Promise(T=>{let E=new FileReader;E.onload=()=>{if(typeof E.result!="string")throw r("InvalidFileResultType",{resultType:typeof E.result});let b=E.result.match(Xt);if(!b?.groups)throw r("InvalidDataUri",{result:E.result});m.push({name:y.name,contents:b.groups.contents,mime:b.groups.mime})},E.onloadend=()=>T(),E.readAsDataURL(y)}))).then(()=>{j([[i,m]])})};return e.addEventListener("change",d),e.addEventListener("input",d),()=>{e.removeEventListener("change",d),e.removeEventListener("input",d)}}}else if(e instanceof HTMLSelectElement){if(e.multiple){let d=new Map;a=u=>[...u.selectedOptions].map(m=>{let y=d.get(m.value);return y==="string"||y==null?m.value:+m.value}),o=u=>{for(let m of e.options)u.includes(m.value)?(d.set(m.value,"string"),m.selected=!0):u.includes(+m.value)?(d.set(m.value,"number"),m.selected=!0):m.selected=!1}}}else e instanceof HTMLTextAreaElement||(a=d=>"value"in d?d.value:d.getAttribute("value"),o=d=>{"value"in e?e.value=d:e.setAttribute("value",d)});let c=W(i),l=typeof c,f=i;if(Array.isArray(c)&&!(e instanceof HTMLSelectElement&&e.multiple)){let d=n||s,u=document.querySelectorAll(`[${St}\\:${CSS.escape(d)}],[${St}="${CSS.escape(d)}"]`),m=[],y=0;for(let T of u){if(m.push([`${f}.${y}`,a(T,"none")]),e===T)break;y++}j(m,{ifMissing:!0}),f=`${f}.${y}`}else j([[f,a(e,l)]],{ifMissing:!0});let p=()=>{let d=W(f);if(d!=null){let u=a(e,typeof d);u!==Et&&j([[f,u]])}};e.addEventListener("input",p),e.addEventListener("change",p);let S=Pe(()=>{o(W(f))});return()=>{S(),e.removeEventListener("input",p),e.removeEventListener("change",p)}}});var Ae=e=>{if(!e||e.size<=0)return 0;for(let n of e){if(n.endsWith("ms"))return+n.replace("ms","");if(n.endsWith("s"))return+n.replace("s","")*1e3;try{return Number.parseFloat(n)}catch{}}return 0},ie=(e,n,t=!1)=>e?e.has(n.toLowerCase()):t;var en=(e,n)=>(...t)=>{setTimeout(()=>{e(...t)},n)},tn=(e,n,t=!1,s=!0)=>{let r=0;return(...i)=>{r&&clearTimeout(r),t&&!r&&e(...i),r=setTimeout(()=>{s&&e(...i),r&&clearTimeout(r),r=0},n)}},nn=(e,n,t=!0,s=!1)=>{let r=!1;return(...i)=>{r||(t&&e(...i),r=!0,setTimeout(()=>{s&&e(...i),r=!1},n))}},Tt=(e,n)=>{let t=n.get("delay");if(t){let i=Ae(t);e=en(e,i)}let s=n.get("debounce");if(s){let i=Ae(s),a=ie(s,"leading",!1),o=!ie(s,"notrailing",!1);e=tn(e,i,a,o)}let r=n.get("throttle");if(r){let i=Ae(r),a=!ie(r,"noleading",!1),o=ie(r,"trailing",!1);e=nn(e,i,a,o)}return e};var We=!!document.startViewTransition,Rt=(e,n)=>{if(n.has("viewtransition")&&We){let t=e;e=(...s)=>document.startViewTransition(()=>t(...s))}return e};te({name:"on",requirement:"must",argNames:["evt"],apply({el:e,key:n,mods:t,rx:s}){let r=e;t.has("window")&&(r=window);let i=c=>{c&&(t.has("prevent")&&c.preventDefault(),t.has("stop")&&c.stopPropagation()),q(),s(c),G()};i=Rt(i,t),i=Tt(i,t);let a={capture:t.has("capture"),passive:t.has("passive"),once:t.has("once")};if(t.has("outside")){r=document;let c=i;i=l=>{e.contains(l?.target)||c(l)}}let o=le(n,t,"kebab");if((o===V||o===ce)&&(r=document),e instanceof HTMLFormElement&&o==="submit"){let c=i;i=l=>{l?.preventDefault(),c(l)}}return r.addEventListener(o,i,a),()=>{r.removeEventListener(o,i)}}});Ie({name:"datastar-patch-elements",apply(e,{elements:n="",selector:t="",mode:s="outer",useViewTransition:r}){switch(s){case"remove":case"outer":case"inner":case"replace":case"prepend":case"append":case"before":case"after":break;default:throw e.error("PatchElementsInvalidMode",{mode:s})}if(!t&&s!=="outer"&&s!=="replace")throw e.error("PatchElementsExpectedSelector");let i={mode:s,selector:t,elements:n,useViewTransition:r?.trim()==="true"};We&&r?document.startViewTransition(()=>At(e,i)):At(e,i)}});var At=({error:e},{elements:n,selector:t,mode:s})=>{let r=n.replace(/<svg(\s[^>]*>|>)([\s\S]*?)<\/svg>/gim,""),i=/<\/html>/.test(r),a=/<\/head>/.test(r),o=/<\/body>/.test(r),c=new DOMParser().parseFromString(i||a||o?n:`<body><template>${n}</template></body>`,"text/html"),l=document.createDocumentFragment();if(i?l.appendChild(c.documentElement):a&&o?(l.appendChild(c.head),l.appendChild(c.body)):a?l.appendChild(c.head):o?l.appendChild(c.body):l=c.querySelector("template").content,!t&&(s==="outer"||s==="replace"))for(let f of l.children){let p;if(f instanceof HTMLHtmlElement)p=document.documentElement;else if(f instanceof HTMLBodyElement)p=document.body;else if(f instanceof HTMLHeadElement)p=document.head;else if(p=document.getElementById(f.id),!p){console.warn(e("PatchElementsNoTargetsFound"),{element:{id:f.id}});continue}xt(s,f,[p])}else{let f=document.querySelectorAll(t);if(!f.length){console.warn(e("PatchElementsNoTargetsFound"),{selector:t});return}xt(s,l,f)}},je=new WeakSet;for(let e of document.querySelectorAll("script"))je.add(e);var Mt=e=>{let n=e instanceof HTMLScriptElement?[e]:e.querySelectorAll("script");for(let t of n)if(!je.has(t)){let s=document.createElement("script");for(let{name:r,value:i}of t.attributes)s.setAttribute(r,i);s.text=t.text,t.replaceWith(s),je.add(s)}},wt=(e,n,t)=>{for(let s of e){let r=n.cloneNode(!0);Mt(r),s[t](r)}},xt=(e,n,t)=>{switch(e){case"remove":for(let s of t)s.remove();break;case"outer":case"inner":for(let s of t)Ge(s,n.cloneNode(!0),e),Mt(s);break;case"replace":wt(t,n,"replaceWith");break;case"prepend":case"append":case"before":case"after":wt(t,n,e)}};export{U as action,ft as actions,te as attribute,q as beginBatch,Ft as computed,Pe as effect,G as endBatch,De as filtered,W as getPath,it as mergePatch,j as mergePaths,Ge as morph,D as root,Y as signal,ve as startPeeking,be as stopPeeking,Ie as watcher};
//# sourceMappingURL=datastar-1-0-0-dcdf08071b5ae5a7.js.map

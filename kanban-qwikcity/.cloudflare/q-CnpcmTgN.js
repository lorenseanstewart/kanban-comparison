import{c as W,i as y,b as o,d as O,S as _s,u as K,e as Ce,f as g,g as me,F as Me,h as _,r as tt,j as be,k as Ye,l as L,m as G,L as ft,n as Ht,o as Xt,p as Ns,q as Ts}from"./q-BPB3CBw9.js";const As=()=>o("div",null,{"data-theme":"pastel",class:"min-h-screen bg-base-300 text-base-content"},o("div",null,{class:"container mx-auto px-4"},O(_s,null,3,"yB_0"),1,null),1,"yB_1"),Qs=W(y(As,"s_VKFlAWJuVm8")),Bs=Object.freeze(Object.defineProperty({__proto__:null,default:Qs},Symbol.toStringTag,{value:"Module"})),h=Symbol.for("drizzle:entityKind");function m(s,e){if(!s||typeof s!="object")return!1;if(s instanceof e)return!0;if(!Object.prototype.hasOwnProperty.call(e,h))throw new Error(`Class "${e.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let t=Object.getPrototypeOf(s).constructor;if(t)for(;t;){if(h in t&&t[h]===e[h])return!0;t=Object.getPrototypeOf(t)}return!1}class q{constructor(e,t){this.table=e,this.config=t,this.name=t.name,this.keyAsName=t.keyAsName,this.notNull=t.notNull,this.default=t.default,this.defaultFn=t.defaultFn,this.onUpdateFn=t.onUpdateFn,this.hasDefault=t.hasDefault,this.primary=t.primaryKey,this.isUnique=t.isUnique,this.uniqueName=t.uniqueName,this.uniqueType=t.uniqueType,this.dataType=t.dataType,this.columnType=t.columnType,this.generated=t.generated,this.generatedIdentity=t.generatedIdentity}static[h]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}}class $s{static[h]="ColumnBuilder";config;constructor(e,t,n){this.config={name:e,keyAsName:e==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:t,columnType:n,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){this.config.name===""&&(this.config.name=e)}}const we=Symbol.for("drizzle:Name"),Dt=Symbol.for("drizzle:isPgEnum");function Ds(s){return!!s&&typeof s=="function"&&Dt in s&&s[Dt]===!0}class ne{static[h]="Subquery";constructor(e,t,n,a=!1,r=[]){this._={brand:"Subquery",sql:e,selectedFields:t,alias:n,isWith:a,usedTables:r}}}class Zt extends ne{static[h]="WithSubquery"}const Es={startActiveSpan(s,e){return e()}},j=Symbol.for("drizzle:ViewBaseConfig"),Je=Symbol.for("drizzle:Schema"),ht=Symbol.for("drizzle:Columns"),Et=Symbol.for("drizzle:ExtraConfigColumns"),it=Symbol.for("drizzle:OriginalName"),lt=Symbol.for("drizzle:BaseName"),He=Symbol.for("drizzle:IsAlias"),Ot=Symbol.for("drizzle:ExtraConfigBuilder"),Os=Symbol.for("drizzle:IsDrizzleTable");class b{static[h]="Table";static Symbol={Name:we,Schema:Je,OriginalName:it,Columns:ht,ExtraConfigColumns:Et,BaseName:lt,IsAlias:He,ExtraConfigBuilder:Ot};[we];[it];[Je];[ht];[Et];[lt];[He]=!1;[Os]=!0;[Ot]=void 0;constructor(e,t,n){this[we]=this[it]=e,this[Je]=t,this[lt]=n}}function Ee(s){return s[we]}function Pe(s){return`${s[Je]??"public"}.${s[we]}`}function Gt(s){return s!=null&&typeof s.getSQL=="function"}function qs(s){const e={sql:"",params:[]};for(const t of s)e.sql+=t.sql,e.params.push(...t.params),t.typings?.length&&(e.typings||(e.typings=[]),e.typings.push(...t.typings));return e}class P{static[h]="StringChunk";value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new w([this])}}class w{constructor(e){this.queryChunks=e;for(const t of e)if(m(t,b)){const n=t[b.Symbol.Schema];this.usedTables.push(n===void 0?t[b.Symbol.Name]:n+"."+t[b.Symbol.Name])}}static[h]="SQL";decoder=es;shouldInlineParams=!1;usedTables=[];append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return Es.startActiveSpan("drizzle.buildSQL",t=>{const n=this.buildQueryFromSourceParams(this.queryChunks,e);return t?.setAttributes({"drizzle.query.text":n.sql,"drizzle.query.params":JSON.stringify(n.params)}),n})}buildQueryFromSourceParams(e,t){const n=Object.assign({},t,{inlineParams:t.inlineParams||this.shouldInlineParams,paramStartIndex:t.paramStartIndex||{value:0}}),{casing:a,escapeName:r,escapeParam:i,prepareTyping:l,inlineParams:d,paramStartIndex:f}=n;return qs(e.map(u=>{if(m(u,P))return{sql:u.value.join(""),params:[]};if(m(u,mt))return{sql:r(u.value),params:[]};if(u===void 0)return{sql:"",params:[]};if(Array.isArray(u)){const p=[new P("(")];for(const[v,S]of u.entries())p.push(S),v<u.length-1&&p.push(new P(", "));return p.push(new P(")")),this.buildQueryFromSourceParams(p,n)}if(m(u,w))return this.buildQueryFromSourceParams(u.queryChunks,{...n,inlineParams:d||u.shouldInlineParams});if(m(u,b)){const p=u[b.Symbol.Schema],v=u[b.Symbol.Name];return{sql:p===void 0||u[He]?r(v):r(p)+"."+r(v),params:[]}}if(m(u,q)){const p=a.getColumnCasing(u);if(t.invokeSource==="indexes")return{sql:r(p),params:[]};const v=u.table[b.Symbol.Schema];return{sql:u.table[He]||v===void 0?r(u.table[b.Symbol.Name])+"."+r(p):r(v)+"."+r(u.table[b.Symbol.Name])+"."+r(p),params:[]}}if(m(u,Re)){const p=u[j].schema,v=u[j].name;return{sql:p===void 0||u[j].isAlias?r(v):r(p)+"."+r(v),params:[]}}if(m(u,ve)){if(m(u.value,Oe))return{sql:i(f.value++,u),params:[u],typings:["none"]};const p=u.value===null?null:u.encoder.mapToDriverValue(u.value);if(m(p,w))return this.buildQueryFromSourceParams([p],n);if(d)return{sql:this.mapInlineParam(p,n),params:[]};let v=["none"];return l&&(v=[l(u.encoder)]),{sql:i(f.value++,p),params:[p],typings:v}}return m(u,Oe)?{sql:i(f.value++,u),params:[u],typings:["none"]}:m(u,w.Aliased)&&u.fieldAlias!==void 0?{sql:r(u.fieldAlias),params:[]}:m(u,ne)?u._.isWith?{sql:r(u._.alias),params:[]}:this.buildQueryFromSourceParams([new P("("),u._.sql,new P(") "),new mt(u._.alias)],n):Ds(u)?u.schema?{sql:r(u.schema)+"."+r(u.enumName),params:[]}:{sql:r(u.enumName),params:[]}:Gt(u)?u.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([u.getSQL()],n):this.buildQueryFromSourceParams([new P("("),u.getSQL(),new P(")")],n):d?{sql:this.mapInlineParam(u,n),params:[]}:{sql:i(f.value++,u),params:[u],typings:["none"]}}))}mapInlineParam(e,{escapeString:t}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return t(e);if(typeof e=="object"){const n=e.toString();return t(n==="[object Object]"?JSON.stringify(e):n)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new w.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}}class mt{constructor(e){this.value=e}static[h]="Name";brand;getSQL(){return new w([this])}}function Rs(s){return typeof s=="object"&&s!==null&&"mapToDriverValue"in s&&typeof s.mapToDriverValue=="function"}const es={mapFromDriverValue:s=>s},ts={mapToDriverValue:s=>s};({...es,...ts});class ve{constructor(e,t=ts){this.value=e,this.encoder=t}static[h]="Param";brand;getSQL(){return new w([this])}}function c(s,...e){const t=[];(e.length>0||s.length>0&&s[0]!=="")&&t.push(new P(s[0]));for(const[n,a]of e.entries())t.push(a,new P(s[n+1]));return new w(t)}(s=>{function e(){return new w([])}s.empty=e;function t(d){return new w(d)}s.fromList=t;function n(d){return new w([new P(d)])}s.raw=n;function a(d,f){const u=[];for(const[p,v]of d.entries())p>0&&f!==void 0&&u.push(f),u.push(v);return new w(u)}s.join=a;function r(d){return new mt(d)}s.identifier=r;function i(d){return new Oe(d)}s.placeholder=i;function l(d,f){return new ve(d,f)}s.param=l})(c||(c={}));(s=>{class e{constructor(n,a){this.sql=n,this.fieldAlias=a}static[h]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new e(this.sql,this.fieldAlias)}}s.Aliased=e})(w||(w={}));class Oe{constructor(e){this.name=e}static[h]="Placeholder";getSQL(){return new w([this])}}function Ke(s,e){return s.map(t=>{if(m(t,Oe)){if(!(t.name in e))throw new Error(`No value for placeholder "${t.name}" was provided`);return e[t.name]}if(m(t,ve)&&m(t.value,Oe)){if(!(t.value.name in e))throw new Error(`No value for placeholder "${t.value.name}" was provided`);return t.encoder.mapToDriverValue(e[t.value.name])}return t})}const Fs=Symbol.for("drizzle:IsDrizzleView");class Re{static[h]="View";[j];[Fs]=!0;constructor({name:e,schema:t,selectedFields:n,query:a}){this[j]={name:e,originalName:e,schema:t,selectedFields:n,query:a,isExisting:!a,isAlias:!1}}getSQL(){return new w([this])}}q.prototype.getSQL=function(){return new w([this])};b.prototype.getSQL=function(){return new w([this])};ne.prototype.getSQL=function(){return new w([this])};class Xe{constructor(e){this.table=e}static[h]="ColumnAliasProxyHandler";get(e,t){return t==="table"?this.table:e[t]}}class It{constructor(e,t){this.alias=e,this.replaceOriginalName=t}static[h]="TableAliasProxyHandler";get(e,t){if(t===b.Symbol.IsAlias)return!0;if(t===b.Symbol.Name)return this.alias;if(this.replaceOriginalName&&t===b.Symbol.OriginalName)return this.alias;if(t===j)return{...e[j],name:this.alias,isAlias:!0};if(t===b.Symbol.Columns){const a=e[b.Symbol.Columns];if(!a)return a;const r={};return Object.keys(a).map(i=>{r[i]=new Proxy(a[i],new Xe(new Proxy(e,this)))}),r}const n=e[t];return m(n,q)?new Proxy(n,new Xe(new Proxy(e,this))):n}}function ot(s,e){return new Proxy(s,new It(e,!1))}function ue(s,e){return new Proxy(s,new Xe(new Proxy(s.table,new It(e,!1))))}function ss(s,e){return new w.Aliased(Ze(s.sql,e),s.fieldAlias)}function Ze(s,e){return c.join(s.queryChunks.map(t=>m(t,q)?ue(t,e):m(t,w)?Ze(t,e):m(t,w.Aliased)?ss(t,e):t))}class Ct extends Error{static[h]="DrizzleError";constructor({message:e,cause:t}){super(e),this.name="DrizzleError",this.cause=t}}class pe extends Error{constructor(e,t,n){super(`Failed query: ${e}
params: ${t}`),this.query=e,this.params=t,this.cause=n,Error.captureStackTrace(this,pe),n&&(this.cause=n)}}class Ps extends Ct{static[h]="TransactionRollbackError";constructor(){super({message:"Rollback"})}}class Ms{static[h]="ConsoleLogWriter";write(e){console.log(e)}}class js{static[h]="DefaultLogger";writer;constructor(e){this.writer=e?.writer??new Ms}logQuery(e,t){const n=t.map(r=>{try{return JSON.stringify(r)}catch{return String(r)}}),a=n.length?` -- params: [${n.join(", ")}]`:"";this.writer.write(`Query: ${e}${a}`)}}class Us{static[h]="NoopLogger";logQuery(){}}class Ae{static[h]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}then(e,t){return this.execute().then(e,t)}}function ct(s,e,t){const n={},a=s.reduce((r,{path:i,field:l},d)=>{let f;m(l,q)?f=l:m(l,w)?f=l.decoder:f=l.sql.decoder;let u=r;for(const[p,v]of i.entries())if(p<i.length-1)v in u||(u[v]={}),u=u[v];else{const S=e[d],x=u[v]=S===null?null:f.mapFromDriverValue(S);if(t&&m(l,q)&&i.length===2){const C=i[0];C in n?typeof n[C]=="string"&&n[C]!==Ee(l.table)&&(n[C]=!1):n[C]=x===null?Ee(l.table):!1}}return r},{});if(t&&Object.keys(n).length>0)for(const[r,i]of Object.entries(n))typeof i=="string"&&!t[i]&&(a[r]=null);return a}function Le(s,e){return Object.entries(s).reduce((t,[n,a])=>{if(typeof n!="string")return t;const r=e?[...e,n]:[n];return m(a,q)||m(a,w)||m(a,w.Aliased)?t.push({path:r,field:a}):m(a,b)?t.push(...Le(a[b.Symbol.Columns],r)):t.push(...Le(a,r)),t},[])}function Lt(s,e){const t=Object.keys(s),n=Object.keys(e);if(t.length!==n.length)return!1;for(const[a,r]of t.entries())if(r!==n[a])return!1;return!0}function ns(s,e){const t=Object.entries(e).filter(([,n])=>n!==void 0).map(([n,a])=>m(a,w)||m(a,q)?[n,a]:[n,new ve(a,s[b.Symbol.Columns][n])]);if(t.length===0)throw new Error("No values to set");return Object.fromEntries(t)}function ks(s,e){for(const t of e)for(const n of Object.getOwnPropertyNames(t.prototype))n!=="constructor"&&Object.defineProperty(s.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n)||Object.create(null))}function Ks(s){return s[b.Symbol.Columns]}function bt(s){return m(s,ne)?s._.alias:m(s,Re)?s[j].name:m(s,w)?void 0:s[b.Symbol.IsAlias]?s[b.Symbol.Name]:s[b.Symbol.BaseName]}function je(s,e){return{name:typeof s=="string"&&s.length>0?s:"",config:typeof s=="object"?s:e}}const as=typeof TextDecoder>"u"?null:new TextDecoder,qt=Symbol.for("drizzle:PgInlineForeignKeys"),Rt=Symbol.for("drizzle:EnableRLS");class zs extends b{static[h]="PgTable";static Symbol=Object.assign({},b.Symbol,{InlineForeignKeys:qt,EnableRLS:Rt});[qt]=[];[Rt]=!1;[b.Symbol.ExtraConfigBuilder]=void 0;[b.Symbol.ExtraConfigColumns]={}}let Vs=class{static[h]="PgPrimaryKeyBuilder";columns;name;constructor(e,t){this.columns=e,this.name=t}build(e){return new Js(e,this.columns,this.name)}},Js=class{constructor(e,t,n){this.table=e,this.columns=t,this.name=n}static[h]="PgPrimaryKey";columns;name;getName(){return this.name??`${this.table[zs.Symbol.Name]}_${this.columns.map(e=>e.name).join("_")}_pk`}};function J(s,e){return Rs(e)&&!Gt(s)&&!m(s,ve)&&!m(s,Oe)&&!m(s,q)&&!m(s,b)&&!m(s,Re)?new ve(s,e):s}const Z=(s,e)=>c`${s} = ${J(e,s)}`,Ws=(s,e)=>c`${s} <> ${J(e,s)}`;function pt(...s){const e=s.filter(t=>t!==void 0);if(e.length!==0)return e.length===1?new w(e):new w([new P("("),c.join(e,new P(" and ")),new P(")")])}function Ys(...s){const e=s.filter(t=>t!==void 0);if(e.length!==0)return e.length===1?new w(e):new w([new P("("),c.join(e,new P(" or ")),new P(")")])}function Hs(s){return c`not ${s}`}const Xs=(s,e)=>c`${s} > ${J(e,s)}`,Zs=(s,e)=>c`${s} >= ${J(e,s)}`,Gs=(s,e)=>c`${s} < ${J(e,s)}`,en=(s,e)=>c`${s} <= ${J(e,s)}`;function We(s,e){return Array.isArray(e)?e.length===0?c`false`:c`${s} in ${e.map(t=>J(t,s))}`:c`${s} in ${J(e,s)}`}function tn(s,e){return Array.isArray(e)?e.length===0?c`true`:c`${s} not in ${e.map(t=>J(t,s))}`:c`${s} not in ${J(e,s)}`}function sn(s){return c`${s} is null`}function nn(s){return c`${s} is not null`}function an(s){return c`exists ${s}`}function rn(s){return c`not exists ${s}`}function ln(s,e,t){return c`${s} between ${J(e,s)} and ${J(t,s)}`}function on(s,e,t){return c`${s} not between ${J(e,s)} and ${J(t,s)}`}function cn(s,e){return c`${s} like ${e}`}function dn(s,e){return c`${s} not like ${e}`}function un(s,e){return c`${s} ilike ${e}`}function fn(s,e){return c`${s} not ilike ${e}`}function Ie(s){return c`${s} asc`}function hn(s){return c`${s} desc`}class rs{constructor(e,t,n){this.sourceTable=e,this.referencedTable=t,this.relationName=n,this.referencedTableName=t[b.Symbol.Name]}static[h]="Relation";referencedTableName;fieldName}class mn{constructor(e,t){this.table=e,this.config=t}static[h]="Relations"}class _e extends rs{constructor(e,t,n,a){super(e,t,n?.relationName),this.config=n,this.isNullable=a}static[h]="One";withFieldName(e){const t=new _e(this.sourceTable,this.referencedTable,this.config,this.isNullable);return t.fieldName=e,t}}class st extends rs{constructor(e,t,n){super(e,t,n?.relationName),this.config=n}static[h]="Many";withFieldName(e){const t=new st(this.sourceTable,this.referencedTable,this.config);return t.fieldName=e,t}}function bn(){return{and:pt,between:ln,eq:Z,exists:an,gt:Xs,gte:Zs,ilike:un,inArray:We,isNull:sn,isNotNull:nn,like:cn,lt:Gs,lte:en,ne:Ws,not:Hs,notBetween:on,notExists:rn,notLike:dn,notIlike:fn,notInArray:tn,or:Ys,sql:c}}function pn(){return{sql:c,asc:Ie,desc:hn}}function gn(s,e){Object.keys(s).length===1&&"default"in s&&!m(s.default,b)&&(s=s.default);const t={},n={},a={};for(const[r,i]of Object.entries(s))if(m(i,b)){const l=Pe(i),d=n[l];t[l]=r,a[r]={tsName:r,dbName:i[b.Symbol.Name],schema:i[b.Symbol.Schema],columns:i[b.Symbol.Columns],relations:d?.relations??{},primaryKey:d?.primaryKey??[]};for(const u of Object.values(i[b.Symbol.Columns]))u.primary&&a[r].primaryKey.push(u);const f=i[b.Symbol.ExtraConfigBuilder]?.(i[b.Symbol.ExtraConfigColumns]);if(f)for(const u of Object.values(f))m(u,Vs)&&a[r].primaryKey.push(...u.columns)}else if(m(i,mn)){const l=Pe(i.table),d=t[l],f=i.config(e(i.table));let u;for(const[p,v]of Object.entries(f))if(d){const S=a[d];S.relations[p]=v}else l in n||(n[l]={relations:{},primaryKey:u}),n[l].relations[p]=v}return{tables:a,tableNamesMap:t}}function yn(s){return function(t,n){return new _e(s,t,n,n?.fields.reduce((a,r)=>a&&r.notNull,!0)??!1)}}function wn(s){return function(t,n){return new st(s,t,n)}}function vn(s,e,t){if(m(t,_e)&&t.config)return{fields:t.config.fields,references:t.config.references};const n=e[Pe(t.referencedTable)];if(!n)throw new Error(`Table "${t.referencedTable[b.Symbol.Name]}" not found in schema`);const a=s[n];if(!a)throw new Error(`Table "${n}" not found in schema`);const r=t.sourceTable,i=e[Pe(r)];if(!i)throw new Error(`Table "${r[b.Symbol.Name]}" not found in schema`);const l=[];for(const d of Object.values(a.relations))(t.relationName&&t!==d&&d.relationName===t.relationName||!t.relationName&&d.referencedTable===t.sourceTable)&&l.push(d);if(l.length>1)throw t.relationName?new Error(`There are multiple relations with name "${t.relationName}" in table "${n}"`):new Error(`There are multiple relations between "${n}" and "${t.sourceTable[b.Symbol.Name]}". Please specify relation name`);if(l[0]&&m(l[0],_e)&&l[0].config)return{fields:l[0].config.references,references:l[0].config.fields};throw new Error(`There is not enough information to infer relation "${i}.${t.fieldName}"`)}function Sn(s){return{one:yn(s),many:wn(s)}}function gt(s,e,t,n,a=r=>r){const r={};for(const[i,l]of n.entries())if(l.isJson){const d=e.relations[l.tsKey],f=t[i],u=typeof f=="string"?JSON.parse(f):f;r[l.tsKey]=m(d,_e)?u&&gt(s,s[l.relationTableTsKey],u,l.selection,a):u.map(p=>gt(s,s[l.relationTableTsKey],p,l.selection,a))}else{const d=a(t[i]),f=l.field;let u;m(f,q)?u=f:m(f,w)?u=f.decoder:u=f.sql.decoder,r[l.tsKey]=d===null?null:u.mapFromDriverValue(d)}return r}function xn(s){return c`max(${s})`.mapWith(m(s,q)?s:String)}class k{static[h]="SelectionProxyHandler";config;constructor(e){this.config={...e}}get(e,t){if(t==="_")return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(t===j)return{...e[j],selectedFields:new Proxy(e[j].selectedFields,this)};if(typeof t=="symbol")return e[t];const a=(m(e,ne)?e._.selectedFields:m(e,Re)?e[j].selectedFields:e)[t];if(m(a,w.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!a.isSelectionField)return a.sql;const r=a.clone();return r.isSelectionField=!0,r}if(m(a,w)){if(this.config.sqlBehavior==="sql")return a;throw new Error(`You tried to reference "${t}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return m(a,q)?this.config.alias?new Proxy(a,new Xe(new Proxy(a.table,new It(this.config.alias,this.config.replaceOriginalName??!1)))):a:typeof a!="object"||a===null?a:new Proxy(a,new k(this.config))}}class In{static[h]="SQLiteForeignKeyBuilder";reference;_onUpdate;_onDelete;constructor(e,t){this.reference=()=>{const{name:n,columns:a,foreignColumns:r}=e();return{name:n,columns:a,foreignTable:r[0].table,foreignColumns:r}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=e,this}onDelete(e){return this._onDelete=e,this}build(e){return new Cn(e,this)}}class Cn{constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}static[h]="SQLiteForeignKey";reference;onUpdate;onDelete;getName(){const{name:e,columns:t,foreignColumns:n}=this.reference(),a=t.map(l=>l.name),r=n.map(l=>l.name),i=[this.table[we],...a,n[0].table[we],...r];return e??`${i.join("_")}_fk`}}function Ln(s,e){return`${s[we]}_${e.join("_")}_unique`}class ie extends $s{static[h]="SQLiteColumnBuilder";foreignKeyConfigs=[];references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}unique(e){return this.config.isUnique=!0,this.config.uniqueName=e,this}generatedAlwaysAs(e,t){return this.config.generated={as:e,type:"always",mode:t?.mode??"virtual"},this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map(({ref:n,actions:a})=>((r,i)=>{const l=new In(()=>{const d=r();return{columns:[e],foreignColumns:[d]}});return i.onUpdate&&l.onUpdate(i.onUpdate),i.onDelete&&l.onDelete(i.onDelete),l.build(t)})(n,a))}}class V extends q{constructor(e,t){t.uniqueName||(t.uniqueName=Ln(e,[t.name])),super(e,t),this.table=e}static[h]="SQLiteColumn"}class _n extends ie{static[h]="SQLiteBigIntBuilder";constructor(e){super(e,"bigint","SQLiteBigInt")}build(e){return new Nn(e,this.config)}}class Nn extends V{static[h]="SQLiteBigInt";getSQLType(){return"blob"}mapFromDriverValue(e){if(typeof Buffer<"u"&&Buffer.from){const t=Buffer.isBuffer(e)?e:e instanceof ArrayBuffer?Buffer.from(e):e.buffer?Buffer.from(e.buffer,e.byteOffset,e.byteLength):Buffer.from(e);return BigInt(t.toString("utf8"))}return BigInt(as.decode(e))}mapToDriverValue(e){return Buffer.from(e.toString())}}class Tn extends ie{static[h]="SQLiteBlobJsonBuilder";constructor(e){super(e,"json","SQLiteBlobJson")}build(e){return new An(e,this.config)}}class An extends V{static[h]="SQLiteBlobJson";getSQLType(){return"blob"}mapFromDriverValue(e){if(typeof Buffer<"u"&&Buffer.from){const t=Buffer.isBuffer(e)?e:e instanceof ArrayBuffer?Buffer.from(e):e.buffer?Buffer.from(e.buffer,e.byteOffset,e.byteLength):Buffer.from(e);return JSON.parse(t.toString("utf8"))}return JSON.parse(as.decode(e))}mapToDriverValue(e){return Buffer.from(JSON.stringify(e))}}class Qn extends ie{static[h]="SQLiteBlobBufferBuilder";constructor(e){super(e,"buffer","SQLiteBlobBuffer")}build(e){return new Bn(e,this.config)}}class Bn extends V{static[h]="SQLiteBlobBuffer";mapFromDriverValue(e){return Buffer.isBuffer(e)?e:Buffer.from(e)}getSQLType(){return"blob"}}function $n(s,e){const{name:t,config:n}=je(s,e);return n?.mode==="json"?new Tn(t):n?.mode==="bigint"?new _n(t):new Qn(t)}class Dn extends ie{static[h]="SQLiteCustomColumnBuilder";constructor(e,t,n){super(e,"custom","SQLiteCustomColumn"),this.config.fieldConfig=t,this.config.customTypeParams=n}build(e){return new En(e,this.config)}}class En extends V{static[h]="SQLiteCustomColumn";sqlName;mapTo;mapFrom;constructor(e,t){super(e,t),this.sqlName=t.customTypeParams.dataType(t.fieldConfig),this.mapTo=t.customTypeParams.toDriver,this.mapFrom=t.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(e){return typeof this.mapFrom=="function"?this.mapFrom(e):e}mapToDriverValue(e){return typeof this.mapTo=="function"?this.mapTo(e):e}}function On(s){return(e,t)=>{const{name:n,config:a}=je(e,t);return new Dn(n,a,s)}}class _t extends ie{static[h]="SQLiteBaseIntegerBuilder";constructor(e,t,n){super(e,t,n),this.config.autoIncrement=!1}primaryKey(e){return e?.autoIncrement&&(this.config.autoIncrement=!0),this.config.hasDefault=!0,super.primaryKey()}}class Nt extends V{static[h]="SQLiteBaseInteger";autoIncrement=this.config.autoIncrement;getSQLType(){return"integer"}}class qn extends _t{static[h]="SQLiteIntegerBuilder";constructor(e){super(e,"number","SQLiteInteger")}build(e){return new Rn(e,this.config)}}class Rn extends Nt{static[h]="SQLiteInteger"}class Fn extends _t{static[h]="SQLiteTimestampBuilder";constructor(e,t){super(e,"date","SQLiteTimestamp"),this.config.mode=t}defaultNow(){return this.default(c`(cast((julianday('now') - 2440587.5)*86400000 as integer))`)}build(e){return new Pn(e,this.config)}}class Pn extends Nt{static[h]="SQLiteTimestamp";mode=this.config.mode;mapFromDriverValue(e){return this.config.mode==="timestamp"?new Date(e*1e3):new Date(e)}mapToDriverValue(e){const t=e.getTime();return this.config.mode==="timestamp"?Math.floor(t/1e3):t}}class Mn extends _t{static[h]="SQLiteBooleanBuilder";constructor(e,t){super(e,"boolean","SQLiteBoolean"),this.config.mode=t}build(e){return new jn(e,this.config)}}class jn extends Nt{static[h]="SQLiteBoolean";mode=this.config.mode;mapFromDriverValue(e){return Number(e)===1}mapToDriverValue(e){return e?1:0}}function fe(s,e){const{name:t,config:n}=je(s,e);return n?.mode==="timestamp"||n?.mode==="timestamp_ms"?new Fn(t,n.mode):n?.mode==="boolean"?new Mn(t,n.mode):new qn(t)}class Un extends ie{static[h]="SQLiteNumericBuilder";constructor(e){super(e,"string","SQLiteNumeric")}build(e){return new kn(e,this.config)}}class kn extends V{static[h]="SQLiteNumeric";mapFromDriverValue(e){return typeof e=="string"?e:String(e)}getSQLType(){return"numeric"}}class Kn extends ie{static[h]="SQLiteNumericNumberBuilder";constructor(e){super(e,"number","SQLiteNumericNumber")}build(e){return new zn(e,this.config)}}class zn extends V{static[h]="SQLiteNumericNumber";mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}mapToDriverValue=String;getSQLType(){return"numeric"}}class Vn extends ie{static[h]="SQLiteNumericBigIntBuilder";constructor(e){super(e,"bigint","SQLiteNumericBigInt")}build(e){return new Jn(e,this.config)}}class Jn extends V{static[h]="SQLiteNumericBigInt";mapFromDriverValue=BigInt;mapToDriverValue=String;getSQLType(){return"numeric"}}function Wn(s,e){const{name:t,config:n}=je(s,e),a=n?.mode;return a==="number"?new Kn(t):a==="bigint"?new Vn(t):new Un(t)}class Yn extends ie{static[h]="SQLiteRealBuilder";constructor(e){super(e,"number","SQLiteReal")}build(e){return new Hn(e,this.config)}}class Hn extends V{static[h]="SQLiteReal";getSQLType(){return"real"}}function Xn(s){return new Yn(s??"")}class Zn extends ie{static[h]="SQLiteTextBuilder";constructor(e,t){super(e,"string","SQLiteText"),this.config.enumValues=t.enum,this.config.length=t.length}build(e){return new Gn(e,this.config)}}class Gn extends V{static[h]="SQLiteText";enumValues=this.config.enumValues;length=this.config.length;constructor(e,t){super(e,t)}getSQLType(){return`text${this.config.length?`(${this.config.length})`:""}`}}class ea extends ie{static[h]="SQLiteTextJsonBuilder";constructor(e){super(e,"json","SQLiteTextJson")}build(e){return new ta(e,this.config)}}class ta extends V{static[h]="SQLiteTextJson";getSQLType(){return"text"}mapFromDriverValue(e){return JSON.parse(e)}mapToDriverValue(e){return JSON.stringify(e)}}function E(s,e={}){const{name:t,config:n}=je(s,e);return n.mode==="json"?new ea(t):new Zn(t,n)}function sa(){return{blob:$n,customType:On,integer:fe,numeric:Wn,real:Xn,text:E}}const yt=Symbol.for("drizzle:SQLiteInlineForeignKeys");class Y extends b{static[h]="SQLiteTable";static Symbol=Object.assign({},b.Symbol,{InlineForeignKeys:yt});[b.Symbol.Columns];[yt]=[];[b.Symbol.ExtraConfigBuilder]=void 0}function na(s,e,t,n,a=s){const r=new Y(s,n,a),i=typeof e=="function"?e(sa()):e,l=Object.fromEntries(Object.entries(i).map(([f,u])=>{const p=u;p.setName(f);const v=p.build(r);return r[yt].push(...p.buildForeignKeys(v,r)),[f,v]})),d=Object.assign(r,l);return d[b.Symbol.Columns]=l,d[b.Symbol.ExtraConfigColumns]=l,t&&(d[Y.Symbol.ExtraConfigBuilder]=t),d}const Qe=(s,e,t)=>na(s,e,t);class aa{constructor(e,t){this.name=e,this.unique=t}static[h]="SQLiteIndexBuilderOn";on(...e){return new ra(this.name,e,this.unique)}}class ra{static[h]="SQLiteIndexBuilder";config;constructor(e,t,n){this.config={name:e,columns:t,unique:n,where:void 0}}where(e){return this.config.where=e,this}build(e){return new ia(this.config,e)}}class ia{static[h]="SQLiteIndex";config;constructor(e,t){this.config={...e,table:t}}}function oe(s){return new aa(s,!1)}function la(...s){return s[0].columns?new Ft(s[0].columns,s[0].name):new Ft(s)}class Ft{static[h]="SQLitePrimaryKeyBuilder";columns;name;constructor(e,t){this.columns=e,this.name=t}build(e){return new oa(e,this.columns,this.name)}}class oa{constructor(e,t,n){this.table=e,this.columns=t,this.name=n}static[h]="SQLitePrimaryKey";columns;name;getName(){return this.name??`${this.table[Y.Symbol.Name]}_${this.columns.map(e=>e.name).join("_")}_pk`}}function xe(s){return m(s,Y)?[`${s[b.Symbol.BaseName]}`]:m(s,ne)?s._.usedTables??[]:m(s,w)?s.usedTables??[]:[]}class Pt extends Ae{constructor(e,t,n,a){super(),this.table=e,this.session=t,this.dialect=n,this.config={table:e,withList:a}}static[h]="SQLiteDelete";config;where(e){return this.config.where=e,this}orderBy(...e){if(typeof e[0]=="function"){const t=e[0](new Proxy(this.config.table[b.Symbol.Columns],new k({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),n=Array.isArray(t)?t:[t];this.config.orderBy=n}else{const t=e;this.config.orderBy=t}return this}limit(e){return this.config.limit=e,this}returning(e=this.table[Y.Symbol.Columns]){return this.config.returning=Le(e),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){const{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e=!0){return this.session[e?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),this.config.returning,this.config.returning?"all":"run",!0,void 0,{type:"delete",tables:xe(this.config.table)})}prepare(){return this._prepare(!1)}run=e=>this._prepare().run(e);all=e=>this._prepare().all(e);get=e=>this._prepare().get(e);values=e=>this._prepare().values(e);async execute(e){return this._prepare().execute(e)}$dynamic(){return this}}function ca(s){return(s.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(t=>t.toLowerCase()).join("_")}function da(s){return(s.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((t,n,a)=>{const r=a===0?n.toLowerCase():`${n[0].toUpperCase()}${n.slice(1)}`;return t+r},"")}function ua(s){return s}class fa{static[h]="CasingCache";cache={};cachedTables={};convert;constructor(e){this.convert=e==="snake_case"?ca:e==="camelCase"?da:ua}getColumnCasing(e){if(!e.keyAsName)return e.name;const t=e.table[b.Symbol.Schema]??"public",n=e.table[b.Symbol.OriginalName],a=`${t}.${n}.${e.name}`;return this.cache[a]||this.cacheTable(e.table),this.cache[a]}cacheTable(e){const t=e[b.Symbol.Schema]??"public",n=e[b.Symbol.OriginalName],a=`${t}.${n}`;if(!this.cachedTables[a]){for(const r of Object.values(e[b.Symbol.Columns])){const i=`${a}.${r.name}`;this.cache[i]=this.convert(r.name)}this.cachedTables[a]=!0}}clearCache(){this.cache={},this.cachedTables={}}}class Tt extends Re{static[h]="SQLiteViewBase"}class Ge{static[h]="SQLiteDialect";casing;constructor(e){this.casing=new fa(e?.casing)}escapeName(e){return`"${e}"`}escapeParam(e){return"?"}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;const t=[c`with `];for(const[n,a]of e.entries())t.push(c`${c.identifier(a._.alias)} as (${a._.sql})`),n<e.length-1&&t.push(c`, `);return t.push(c` `),c.join(t)}buildDeleteQuery({table:e,where:t,returning:n,withList:a,limit:r,orderBy:i}){const l=this.buildWithCTE(a),d=n?c` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,f=t?c` where ${t}`:void 0,u=this.buildOrderBy(i),p=this.buildLimit(r);return c`${l}delete from ${e}${f}${d}${u}${p}`}buildUpdateSet(e,t){const n=e[b.Symbol.Columns],a=Object.keys(n).filter(i=>t[i]!==void 0||n[i]?.onUpdateFn!==void 0),r=a.length;return c.join(a.flatMap((i,l)=>{const d=n[i],f=t[i]??c.param(d.onUpdateFn(),d),u=c`${c.identifier(this.casing.getColumnCasing(d))} = ${f}`;return l<r-1?[u,c.raw(", ")]:[u]}))}buildUpdateQuery({table:e,set:t,where:n,returning:a,withList:r,joins:i,from:l,limit:d,orderBy:f}){const u=this.buildWithCTE(r),p=this.buildUpdateSet(e,t),v=l&&c.join([c.raw(" from "),this.buildFromTable(l)]),S=this.buildJoins(i),x=a?c` returning ${this.buildSelection(a,{isSingleTable:!0})}`:void 0,C=n?c` where ${n}`:void 0,D=this.buildOrderBy(f),N=this.buildLimit(d);return c`${u}update ${e} set ${p}${v}${S}${C}${x}${D}${N}`}buildSelection(e,{isSingleTable:t=!1}={}){const n=e.length,a=e.flatMap(({field:r},i)=>{const l=[];if(m(r,w.Aliased)&&r.isSelectionField)l.push(c.identifier(r.fieldAlias));else if(m(r,w.Aliased)||m(r,w)){const d=m(r,w.Aliased)?r.sql:r;t?l.push(new w(d.queryChunks.map(f=>m(f,q)?c.identifier(this.casing.getColumnCasing(f)):f))):l.push(d),m(r,w.Aliased)&&l.push(c` as ${c.identifier(r.fieldAlias)}`)}else if(m(r,q)){const d=r.table[b.Symbol.Name];r.columnType==="SQLiteNumericBigInt"?t?l.push(c`cast(${c.identifier(this.casing.getColumnCasing(r))} as text)`):l.push(c`cast(${c.identifier(d)}.${c.identifier(this.casing.getColumnCasing(r))} as text)`):t?l.push(c.identifier(this.casing.getColumnCasing(r))):l.push(c`${c.identifier(d)}.${c.identifier(this.casing.getColumnCasing(r))}`)}return i<n-1&&l.push(c`, `),l});return c.join(a)}buildJoins(e){if(!e||e.length===0)return;const t=[];if(e)for(const[n,a]of e.entries()){n===0&&t.push(c` `);const r=a.table,i=a.on?c` on ${a.on}`:void 0;if(m(r,Y)){const l=r[Y.Symbol.Name],d=r[Y.Symbol.Schema],f=r[Y.Symbol.OriginalName],u=l===f?void 0:a.alias;t.push(c`${c.raw(a.joinType)} join ${d?c`${c.identifier(d)}.`:void 0}${c.identifier(f)}${u&&c` ${c.identifier(u)}`}${i}`)}else t.push(c`${c.raw(a.joinType)} join ${r}${i}`);n<e.length-1&&t.push(c` `)}return c.join(t)}buildLimit(e){return typeof e=="object"||typeof e=="number"&&e>=0?c` limit ${e}`:void 0}buildOrderBy(e){const t=[];if(e)for(const[n,a]of e.entries())t.push(a),n<e.length-1&&t.push(c`, `);return t.length>0?c` order by ${c.join(t)}`:void 0}buildFromTable(e){return m(e,b)&&e[b.Symbol.IsAlias]?c`${c`${c.identifier(e[b.Symbol.Schema]??"")}.`.if(e[b.Symbol.Schema])}${c.identifier(e[b.Symbol.OriginalName])} ${c.identifier(e[b.Symbol.Name])}`:e}buildSelectQuery({withList:e,fields:t,fieldsFlat:n,where:a,having:r,table:i,joins:l,orderBy:d,groupBy:f,limit:u,offset:p,distinct:v,setOperators:S}){const x=n??Le(t);for(const ae of x)if(m(ae.field,q)&&Ee(ae.field.table)!==(m(i,ne)?i._.alias:m(i,Tt)?i[j].name:m(i,w)?void 0:Ee(i))&&!(le=>l?.some(({alias:ke})=>ke===(le[b.Symbol.IsAlias]?Ee(le):le[b.Symbol.BaseName])))(ae.field.table)){const le=Ee(ae.field.table);throw new Error(`Your "${ae.path.join("->")}" field references a column "${le}"."${ae.field.name}", but the table "${le}" is not part of the query! Did you forget to join it?`)}const C=!l||l.length===0,D=this.buildWithCTE(e),N=v?c` distinct`:void 0,R=this.buildSelection(x,{isSingleTable:C}),U=this.buildFromTable(i),A=this.buildJoins(l),ce=a?c` where ${a}`:void 0,te=r?c` having ${r}`:void 0,I=[];if(f)for(const[ae,le]of f.entries())I.push(le),ae<f.length-1&&I.push(c`, `);const Q=I.length>0?c` group by ${c.join(I)}`:void 0,de=this.buildOrderBy(d),Ue=this.buildLimit(u),rt=p?c` offset ${p}`:void 0,De=c`${D}select${N} ${R} from ${U}${A}${ce}${Q}${te}${de}${Ue}${rt}`;return S.length>0?this.buildSetOperations(De,S):De}buildSetOperations(e,t){const[n,...a]=t;if(!n)throw new Error("Cannot pass undefined values to any set operator");return a.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:n}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:n}),a)}buildSetOperationQuery({leftSelect:e,setOperator:{type:t,isAll:n,rightSelect:a,limit:r,orderBy:i,offset:l}}){const d=c`${e.getSQL()} `,f=c`${a.getSQL()}`;let u;if(i&&i.length>0){const x=[];for(const C of i)if(m(C,V))x.push(c.identifier(C.name));else if(m(C,w)){for(let D=0;D<C.queryChunks.length;D++){const N=C.queryChunks[D];m(N,V)&&(C.queryChunks[D]=c.identifier(this.casing.getColumnCasing(N)))}x.push(c`${C}`)}else x.push(c`${C}`);u=c` order by ${c.join(x,c`, `)}`}const p=typeof r=="object"||typeof r=="number"&&r>=0?c` limit ${r}`:void 0,v=c.raw(`${t} ${n?"all ":""}`),S=l?c` offset ${l}`:void 0;return c`${d}${v}${f}${u}${p}${S}`}buildInsertQuery({table:e,values:t,onConflict:n,returning:a,withList:r,select:i}){const l=[],d=e[b.Symbol.Columns],f=Object.entries(d).filter(([C,D])=>!D.shouldDisableInsert()),u=f.map(([,C])=>c.identifier(this.casing.getColumnCasing(C)));if(i){const C=t;m(C,w)?l.push(C):l.push(C.getSQL())}else{const C=t;l.push(c.raw("values "));for(const[D,N]of C.entries()){const R=[];for(const[U,A]of f){const ce=N[U];if(ce===void 0||m(ce,ve)&&ce.value===void 0){let te;if(A.default!==null&&A.default!==void 0)te=m(A.default,w)?A.default:c.param(A.default,A);else if(A.defaultFn!==void 0){const I=A.defaultFn();te=m(I,w)?I:c.param(I,A)}else if(!A.default&&A.onUpdateFn!==void 0){const I=A.onUpdateFn();te=m(I,w)?I:c.param(I,A)}else te=c`null`;R.push(te)}else R.push(ce)}l.push(R),D<C.length-1&&l.push(c`, `)}}const p=this.buildWithCTE(r),v=c.join(l),S=a?c` returning ${this.buildSelection(a,{isSingleTable:!0})}`:void 0,x=n?.length?c.join(n):void 0;return c`${p}insert into ${e} ${u} ${v}${x}${S}`}sqlToQuery(e,t){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,invokeSource:t})}buildRelationalQuery({fullSchema:e,schema:t,tableNamesMap:n,table:a,tableConfig:r,queryConfig:i,tableAlias:l,nestedQueryRelation:d,joinOn:f}){let u=[],p,v,S=[],x;const C=[];if(i===!0)u=Object.entries(r.columns).map(([R,U])=>({dbKey:U.name,tsKey:R,field:ue(U,l),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{const N=Object.fromEntries(Object.entries(r.columns).map(([I,Q])=>[I,ue(Q,l)]));if(i.where){const I=typeof i.where=="function"?i.where(N,bn()):i.where;x=I&&Ze(I,l)}const R=[];let U=[];if(i.columns){let I=!1;for(const[Q,de]of Object.entries(i.columns))de!==void 0&&Q in r.columns&&(!I&&de===!0&&(I=!0),U.push(Q));U.length>0&&(U=I?U.filter(Q=>i.columns?.[Q]===!0):Object.keys(r.columns).filter(Q=>!U.includes(Q)))}else U=Object.keys(r.columns);for(const I of U){const Q=r.columns[I];R.push({tsKey:I,value:Q})}let A=[];i.with&&(A=Object.entries(i.with).filter(I=>!!I[1]).map(([I,Q])=>({tsKey:I,queryConfig:Q,relation:r.relations[I]})));let ce;if(i.extras){ce=typeof i.extras=="function"?i.extras(N,{sql:c}):i.extras;for(const[I,Q]of Object.entries(ce))R.push({tsKey:I,value:ss(Q,l)})}for(const{tsKey:I,value:Q}of R)u.push({dbKey:m(Q,w.Aliased)?Q.fieldAlias:r.columns[I].name,tsKey:I,field:m(Q,q)?ue(Q,l):Q,relationTableTsKey:void 0,isJson:!1,selection:[]});let te=typeof i.orderBy=="function"?i.orderBy(N,pn()):i.orderBy??[];Array.isArray(te)||(te=[te]),S=te.map(I=>m(I,q)?ue(I,l):Ze(I,l)),p=i.limit,v=i.offset;for(const{tsKey:I,queryConfig:Q,relation:de}of A){const Ue=vn(t,n,de),rt=Pe(de.referencedTable),De=n[rt],ae=`${l}_${I}`,le=pt(...Ue.fields.map((Cs,Ls)=>Z(ue(Ue.references[Ls],ae),ue(Cs,l)))),ke=this.buildRelationalQuery({fullSchema:e,schema:t,tableNamesMap:n,table:e[De],tableConfig:t[De],queryConfig:m(de,_e)?Q===!0?{limit:1}:{...Q,limit:1}:Q,tableAlias:ae,joinOn:le,nestedQueryRelation:de}),Is=c`(${ke.sql})`.as(I);u.push({dbKey:I,tsKey:I,field:Is,relationTableTsKey:De,isJson:!0,selection:ke.selection})}}if(u.length===0)throw new Ct({message:`No fields selected for table "${r.tsName}" ("${l}"). You need to have at least one item in "columns", "with" or "extras". If you need to select all columns, omit the "columns" key or set it to undefined.`});let D;if(x=pt(f,x),d){let N=c`json_array(${c.join(u.map(({field:A})=>m(A,V)?c.identifier(this.casing.getColumnCasing(A)):m(A,w.Aliased)?A.sql:A),c`, `)})`;m(d,st)&&(N=c`coalesce(json_group_array(${N}), json_array())`);const R=[{dbKey:"data",tsKey:"data",field:N.as("data"),isJson:!0,relationTableTsKey:r.tsName,selection:u}];p!==void 0||v!==void 0||S.length>0?(D=this.buildSelectQuery({table:ot(a,l),fields:{},fieldsFlat:[{path:[],field:c.raw("*")}],where:x,limit:p,offset:v,orderBy:S,setOperators:[]}),x=void 0,p=void 0,v=void 0,S=void 0):D=ot(a,l),D=this.buildSelectQuery({table:m(D,Y)?D:new ne(D,{},l),fields:{},fieldsFlat:R.map(({field:A})=>({path:[],field:m(A,q)?ue(A,l):A})),joins:C,where:x,limit:p,offset:v,orderBy:S,setOperators:[]})}else D=this.buildSelectQuery({table:ot(a,l),fields:{},fieldsFlat:u.map(({field:N})=>({path:[],field:m(N,q)?ue(N,l):N})),joins:C,where:x,limit:p,offset:v,orderBy:S,setOperators:[]});return{tableTsKey:r.tsName,sql:D,selection:u}}}class ha extends Ge{static[h]="SQLiteSyncDialect";migrate(e,t,n){const a=n===void 0||typeof n=="string"?"__drizzle_migrations":n.migrationsTable??"__drizzle_migrations",r=c`
			CREATE TABLE IF NOT EXISTS ${c.identifier(a)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at numeric
			)
		`;t.run(r);const l=t.values(c`SELECT id, hash, created_at FROM ${c.identifier(a)} ORDER BY created_at DESC LIMIT 1`)[0]??void 0;t.run(c`BEGIN`);try{for(const d of e)if(!l||Number(l[2])<d.folderMillis){for(const f of d.sql)t.run(c.raw(f));t.run(c`INSERT INTO ${c.identifier(a)} ("hash", "created_at") VALUES(${d.hash}, ${d.folderMillis})`)}t.run(c`COMMIT`)}catch(d){throw t.run(c`ROLLBACK`),d}}}class ma extends Ge{static[h]="SQLiteAsyncDialect";async migrate(e,t,n){const a=n===void 0||typeof n=="string"?"__drizzle_migrations":n.migrationsTable??"__drizzle_migrations",r=c`
			CREATE TABLE IF NOT EXISTS ${c.identifier(a)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at numeric
			)
		`;await t.run(r);const l=(await t.values(c`SELECT id, hash, created_at FROM ${c.identifier(a)} ORDER BY created_at DESC LIMIT 1`))[0]??void 0;await t.transaction(async d=>{for(const f of e)if(!l||Number(l[2])<f.folderMillis){for(const u of f.sql)await d.run(c.raw(u));await d.run(c`INSERT INTO ${c.identifier(a)} ("hash", "created_at") VALUES(${f.hash}, ${f.folderMillis})`)}})}}class ba{static[h]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}}class ge{static[h]="SQLiteSelectBuilder";fields;session;dialect;withList;distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,this.withList=e.withList,this.distinct=e.distinct}from(e){const t=!!this.fields;let n;return this.fields?n=this.fields:m(e,ne)?n=Object.fromEntries(Object.keys(e._.selectedFields).map(a=>[a,e[a]])):m(e,Tt)?n=e[j].selectedFields:m(e,w)?n={}:n=Ks(e),new is({table:e,fields:n,isPartialSelect:t,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct})}}class pa extends ba{static[h]="SQLiteSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;cacheConfig=void 0;usedTables=new Set;constructor({table:e,fields:t,isPartialSelect:n,session:a,dialect:r,withList:i,distinct:l}){super(),this.config={withList:i,table:e,fields:{...t},distinct:l,setOperators:[]},this.isPartialSelect=n,this.session=a,this.dialect=r,this._={selectedFields:t,config:this.config},this.tableName=bt(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{};for(const d of xe(e))this.usedTables.add(d)}getUsedTables(){return[...this.usedTables]}createJoin(e){return(t,n)=>{const a=this.tableName,r=bt(t);for(const i of xe(t))this.usedTables.add(i);if(typeof r=="string"&&this.config.joins?.some(i=>i.alias===r))throw new Error(`Alias "${r}" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof a=="string"&&(this.config.fields={[a]:this.config.fields}),typeof r=="string"&&!m(t,w))){const i=m(t,ne)?t._.selectedFields:m(t,Re)?t[j].selectedFields:t[b.Symbol.Columns];this.config.fields[r]=i}if(typeof n=="function"&&(n=n(new Proxy(this.config.fields,new k({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:n,table:t,joinType:e,alias:r}),typeof r=="string")switch(e){case"left":{this.joinsNotNullableMap[r]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([i])=>[i,!1])),this.joinsNotNullableMap[r]=!0;break}case"cross":case"inner":{this.joinsNotNullableMap[r]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([i])=>[i,!1])),this.joinsNotNullableMap[r]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");crossJoin=this.createJoin("cross");createSetOperator(e,t){return n=>{const a=typeof n=="function"?n(ga()):n;if(!Lt(this.getSelectedFields(),a.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:t,rightSelect:a}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);except=this.createSetOperator("except",!1);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new k({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new k({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]=="function"){const t=e[0](new Proxy(this.config.fields,new k({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(t)?t:[t]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]=="function"){const t=e[0](new Proxy(this.config.fields,new k({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),n=Array.isArray(t)?t:[t];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=n:this.config.orderBy=n}else{const t=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=t:this.config.orderBy=t}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){const{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}as(e){const t=[];if(t.push(...xe(this.config.table)),this.config.joins)for(const n of this.config.joins)t.push(...xe(n.table));return new Proxy(new ne(this.getSQL(),this.config.fields,e,!1,[...new Set(t)]),new k({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new k({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}}class is extends pa{static[h]="SQLiteSelect";_prepare(e=!0){if(!this.session)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");const t=Le(this.config.fields),n=this.session[e?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),t,"all",!0,void 0,{type:"select",tables:[...this.usedTables]},this.cacheConfig);return n.joinsNotNullableMap=this.joinsNotNullableMap,n}$withCache(e){return this.cacheConfig=e===void 0?{config:{},enable:!0,autoInvalidate:!0}:e===!1?{enable:!1}:{enable:!0,autoInvalidate:!0,...e},this}prepare(){return this._prepare(!1)}run=e=>this._prepare().run(e);all=e=>this._prepare().all(e);get=e=>this._prepare().get(e);values=e=>this._prepare().values(e);async execute(){return this.all()}}ks(is,[Ae]);function nt(s,e){return(t,n,...a)=>{const r=[n,...a].map(i=>({type:s,isAll:e,rightSelect:i}));for(const i of r)if(!Lt(t.getSelectedFields(),i.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return t.addSetOperators(r)}}const ga=()=>({union:ya,unionAll:wa,intersect:va,except:Sa}),ya=nt("union",!1),wa=nt("union",!0),va=nt("intersect",!1),Sa=nt("except",!1);class ls{static[h]="SQLiteQueryBuilder";dialect;dialectConfig;constructor(e){this.dialect=m(e,Ge)?e:void 0,this.dialectConfig=m(e,Ge)?void 0:e}$with=(e,t)=>{const n=this;return{as:r=>(typeof r=="function"&&(r=r(n)),new Proxy(new Zt(r.getSQL(),t??("getSelectedFields"in r?r.getSelectedFields()??{}:{}),e,!0),new k({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};with(...e){const t=this;function n(r){return new ge({fields:r??void 0,session:void 0,dialect:t.getDialect(),withList:e})}function a(r){return new ge({fields:r??void 0,session:void 0,dialect:t.getDialect(),withList:e,distinct:!0})}return{select:n,selectDistinct:a}}select(e){return new ge({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new ge({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}getDialect(){return this.dialect||(this.dialect=new ha(this.dialectConfig)),this.dialect}}class Mt{constructor(e,t,n,a){this.table=e,this.session=t,this.dialect=n,this.withList=a}static[h]="SQLiteInsertBuilder";values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error("values() must be called with at least one value");const t=e.map(n=>{const a={},r=this.table[b.Symbol.Columns];for(const i of Object.keys(n)){const l=n[i];a[i]=m(l,w)?l:new ve(l,r[i])}return a});return new jt(this.table,t,this.session,this.dialect,this.withList)}select(e){const t=typeof e=="function"?e(new ls):e;if(!m(t,w)&&!Lt(this.table[ht],t._.selectedFields))throw new Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new jt(this.table,t,this.session,this.dialect,this.withList,!0)}}class jt extends Ae{constructor(e,t,n,a,r,i){super(),this.session=n,this.dialect=a,this.config={table:e,values:t,withList:r,select:i}}static[h]="SQLiteInsert";config;returning(e=this.config.table[Y.Symbol.Columns]){return this.config.returning=Le(e),this}onConflictDoNothing(e={}){if(this.config.onConflict||(this.config.onConflict=[]),e.target===void 0)this.config.onConflict.push(c` on conflict do nothing`);else{const t=Array.isArray(e.target)?c`${e.target}`:c`${[e.target]}`,n=e.where?c` where ${e.where}`:c``;this.config.onConflict.push(c` on conflict ${t} do nothing${n}`)}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw new Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');this.config.onConflict||(this.config.onConflict=[]);const t=e.where?c` where ${e.where}`:void 0,n=e.targetWhere?c` where ${e.targetWhere}`:void 0,a=e.setWhere?c` where ${e.setWhere}`:void 0,r=Array.isArray(e.target)?c`${e.target}`:c`${[e.target]}`,i=this.dialect.buildUpdateSet(this.config.table,ns(this.config.table,e.set));return this.config.onConflict.push(c` on conflict ${r}${n} do update set ${i}${t}${a}`),this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){const{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e=!0){return this.session[e?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),this.config.returning,this.config.returning?"all":"run",!0,void 0,{type:"insert",tables:xe(this.config.table)})}prepare(){return this._prepare(!1)}run=e=>this._prepare().run(e);all=e=>this._prepare().all(e);get=e=>this._prepare().get(e);values=e=>this._prepare().values(e);async execute(){return this.config.returning?this.all():this.run()}$dynamic(){return this}}class Ut{constructor(e,t,n,a){this.table=e,this.session=t,this.dialect=n,this.withList=a}static[h]="SQLiteUpdateBuilder";set(e){return new xa(this.table,ns(this.table,e),this.session,this.dialect,this.withList)}}class xa extends Ae{constructor(e,t,n,a,r){super(),this.session=n,this.dialect=a,this.config={set:t,table:e,withList:r,joins:[]}}static[h]="SQLiteUpdate";config;from(e){return this.config.from=e,this}createJoin(e){return(t,n)=>{const a=bt(t);if(typeof a=="string"&&this.config.joins.some(r=>r.alias===a))throw new Error(`Alias "${a}" is already used in this query`);if(typeof n=="function"){const r=this.config.from?m(t,Y)?t[b.Symbol.Columns]:m(t,ne)?t._.selectedFields:m(t,Tt)?t[j].selectedFields:void 0:void 0;n=n(new Proxy(this.config.table[b.Symbol.Columns],new k({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),r&&new Proxy(r,new k({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}return this.config.joins.push({on:n,table:t,joinType:e,alias:a}),this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(e){return this.config.where=e,this}orderBy(...e){if(typeof e[0]=="function"){const t=e[0](new Proxy(this.config.table[b.Symbol.Columns],new k({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),n=Array.isArray(t)?t:[t];this.config.orderBy=n}else{const t=e;this.config.orderBy=t}return this}limit(e){return this.config.limit=e,this}returning(e=this.config.table[Y.Symbol.Columns]){return this.config.returning=Le(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){const{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e=!0){return this.session[e?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),this.config.returning,this.config.returning?"all":"run",!0,void 0,{type:"insert",tables:xe(this.config.table)})}prepare(){return this._prepare(!1)}run=e=>this._prepare().run(e);all=e=>this._prepare().all(e);get=e=>this._prepare().get(e);values=e=>this._prepare().values(e);async execute(){return this.config.returning?this.all():this.run()}$dynamic(){return this}}class et extends w{constructor(e){super(et.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.session=e.session,this.sql=et.buildCount(e.source,e.filters)}sql;static[h]="SQLiteCountBuilderAsync";[Symbol.toStringTag]="SQLiteCountBuilderAsync";session;static buildEmbeddedCount(e,t){return c`(select count(*) from ${e}${c.raw(" where ").if(t)}${t})`}static buildCount(e,t){return c`select count(*) from ${e}${c.raw(" where ").if(t)}${t}`}then(e,t){return Promise.resolve(this.session.count(this.sql)).then(e,t)}catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}}class Ia{constructor(e,t,n,a,r,i,l,d){this.mode=e,this.fullSchema=t,this.schema=n,this.tableNamesMap=a,this.table=r,this.tableConfig=i,this.dialect=l,this.session=d}static[h]="SQLiteAsyncRelationalQueryBuilder";findMany(e){return this.mode==="sync"?new kt(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many"):new wt(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many")}findFirst(e){return this.mode==="sync"?new kt(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first"):new wt(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first")}}class wt extends Ae{constructor(e,t,n,a,r,i,l,d,f){super(),this.fullSchema=e,this.schema=t,this.tableNamesMap=n,this.table=a,this.tableConfig=r,this.dialect=i,this.session=l,this.config=d,this.mode=f}static[h]="SQLiteAsyncRelationalQuery";mode;getSQL(){return this.dialect.buildRelationalQuery({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName}).sql}_prepare(e=!1){const{query:t,builtQuery:n}=this._toSQL();return this.session[e?"prepareOneTimeQuery":"prepareQuery"](n,void 0,this.mode==="first"?"get":"all",!0,(a,r)=>{const i=a.map(l=>gt(this.schema,this.tableConfig,l,t.selection,r));return this.mode==="first"?i[0]:i})}prepare(){return this._prepare(!1)}_toSQL(){const e=this.dialect.buildRelationalQuery({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName}),t=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:t}}toSQL(){return this._toSQL().builtQuery}executeRaw(){return this.mode==="first"?this._prepare(!1).get():this._prepare(!1).all()}async execute(){return this.executeRaw()}}class kt extends wt{static[h]="SQLiteSyncRelationalQuery";sync(){return this.executeRaw()}}class ze extends Ae{constructor(e,t,n,a,r){super(),this.execute=e,this.getSQL=t,this.dialect=a,this.mapBatchResult=r,this.config={action:n}}static[h]="SQLiteRaw";config;getQuery(){return{...this.dialect.sqlToQuery(this.getSQL()),method:this.config.action}}mapResult(e,t){return t?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}}class os{constructor(e,t,n,a){this.resultKind=e,this.dialect=t,this.session=n,this._=a?{schema:a.schema,fullSchema:a.fullSchema,tableNamesMap:a.tableNamesMap}:{schema:void 0,fullSchema:{},tableNamesMap:{}},this.query={};const r=this.query;if(this._.schema)for(const[i,l]of Object.entries(this._.schema))r[i]=new Ia(e,a.fullSchema,this._.schema,this._.tableNamesMap,a.fullSchema[i],l,t,n);this.$cache={invalidate:async i=>{}}}static[h]="BaseSQLiteDatabase";query;$with=(e,t)=>{const n=this;return{as:r=>(typeof r=="function"&&(r=r(new ls(n.dialect))),new Proxy(new Zt(r.getSQL(),t??("getSelectedFields"in r?r.getSelectedFields()??{}:{}),e,!0),new k({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};$count(e,t){return new et({source:e,filters:t,session:this.session})}with(...e){const t=this;function n(d){return new ge({fields:d??void 0,session:t.session,dialect:t.dialect,withList:e})}function a(d){return new ge({fields:d??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:!0})}function r(d){return new Ut(d,t.session,t.dialect,e)}function i(d){return new Mt(d,t.session,t.dialect,e)}function l(d){return new Pt(d,t.session,t.dialect,e)}return{select:n,selectDistinct:a,update:r,insert:i,delete:l}}select(e){return new ge({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new ge({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}update(e){return new Ut(e,this.session,this.dialect)}$cache;insert(e){return new Mt(e,this.session,this.dialect)}delete(e){return new Pt(e,this.session,this.dialect)}run(e){const t=typeof e=="string"?c.raw(e):e.getSQL();return this.resultKind==="async"?new ze(async()=>this.session.run(t),()=>t,"run",this.dialect,this.session.extractRawRunValueFromBatchResult.bind(this.session)):this.session.run(t)}all(e){const t=typeof e=="string"?c.raw(e):e.getSQL();return this.resultKind==="async"?new ze(async()=>this.session.all(t),()=>t,"all",this.dialect,this.session.extractRawAllValueFromBatchResult.bind(this.session)):this.session.all(t)}get(e){const t=typeof e=="string"?c.raw(e):e.getSQL();return this.resultKind==="async"?new ze(async()=>this.session.get(t),()=>t,"get",this.dialect,this.session.extractRawGetValueFromBatchResult.bind(this.session)):this.session.get(t)}values(e){const t=typeof e=="string"?c.raw(e):e.getSQL();return this.resultKind==="async"?new ze(async()=>this.session.values(t),()=>t,"values",this.dialect,this.session.extractRawValuesValueFromBatchResult.bind(this.session)):this.session.values(t)}transaction(e,t){return this.session.transaction(e,t)}}class Ca{static[h]="Cache"}class cs extends Ca{strategy(){return"all"}static[h]="NoopCache";async get(e){}async put(e,t,n,a){}async onMutate(e){}}async function Kt(s,e){const t=`${s}-${JSON.stringify(e)}`,a=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",a);return[...new Uint8Array(r)].map(d=>d.toString(16).padStart(2,"0")).join("")}class La extends Ae{constructor(e){super(),this.resultCb=e}static[h]="ExecuteResultSync";async execute(){return this.resultCb()}sync(){return this.resultCb()}}class _a{constructor(e,t,n,a,r,i){this.mode=e,this.executeMethod=t,this.query=n,this.cache=a,this.queryMetadata=r,this.cacheConfig=i,a&&a.strategy()==="all"&&i===void 0&&(this.cacheConfig={enable:!0,autoInvalidate:!0}),this.cacheConfig?.enable||(this.cacheConfig=void 0)}static[h]="PreparedQuery";joinsNotNullableMap;async queryWithCache(e,t,n){if(this.cache===void 0||m(this.cache,cs)||this.queryMetadata===void 0)try{return await n()}catch(a){throw new pe(e,t,a)}if(this.cacheConfig&&!this.cacheConfig.enable)try{return await n()}catch(a){throw new pe(e,t,a)}if((this.queryMetadata.type==="insert"||this.queryMetadata.type==="update"||this.queryMetadata.type==="delete")&&this.queryMetadata.tables.length>0)try{const[a]=await Promise.all([n(),this.cache.onMutate({tables:this.queryMetadata.tables})]);return a}catch(a){throw new pe(e,t,a)}if(!this.cacheConfig)try{return await n()}catch(a){throw new pe(e,t,a)}if(this.queryMetadata.type==="select"){const a=await this.cache.get(this.cacheConfig.tag??await Kt(e,t),this.queryMetadata.tables,this.cacheConfig.tag!==void 0,this.cacheConfig.autoInvalidate);if(a===void 0){let r;try{r=await n()}catch(i){throw new pe(e,t,i)}return await this.cache.put(this.cacheConfig.tag??await Kt(e,t),r,this.cacheConfig.autoInvalidate?this.queryMetadata.tables:[],this.cacheConfig.tag!==void 0,this.cacheConfig.config),r}return a}try{return await n()}catch(a){throw new pe(e,t,a)}}getQuery(){return this.query}mapRunResult(e,t){return e}mapAllResult(e,t){throw new Error("Not implemented")}mapGetResult(e,t){throw new Error("Not implemented")}execute(e){return this.mode==="async"?this[this.executeMethod](e):new La(()=>this[this.executeMethod](e))}mapResult(e,t){switch(this.executeMethod){case"run":return this.mapRunResult(e,t);case"all":return this.mapAllResult(e,t);case"get":return this.mapGetResult(e,t)}}}class Na{constructor(e){this.dialect=e}static[h]="SQLiteSession";prepareOneTimeQuery(e,t,n,a,r,i,l){return this.prepareQuery(e,t,n,a,r,i,l)}run(e){const t=this.dialect.sqlToQuery(e);try{return this.prepareOneTimeQuery(t,void 0,"run",!1).run()}catch(n){throw new Ct({cause:n,message:`Failed to run the query '${t.sql}'`})}}extractRawRunValueFromBatchResult(e){return e}all(e){return this.prepareOneTimeQuery(this.dialect.sqlToQuery(e),void 0,"run",!1).all()}extractRawAllValueFromBatchResult(e){throw new Error("Not implemented")}get(e){return this.prepareOneTimeQuery(this.dialect.sqlToQuery(e),void 0,"run",!1).get()}extractRawGetValueFromBatchResult(e){throw new Error("Not implemented")}values(e){return this.prepareOneTimeQuery(this.dialect.sqlToQuery(e),void 0,"run",!1).values()}async count(e){return(await this.values(e))[0][0]}extractRawValuesValueFromBatchResult(e){throw new Error("Not implemented")}}class Ta extends os{constructor(e,t,n,a,r=0){super(e,t,n,a),this.schema=a,this.nestedIndex=r}static[h]="SQLiteTransaction";rollback(){throw new Ps}}class Aa extends Na{constructor(e,t,n,a={}){super(t),this.client=e,this.schema=n,this.options=a,this.logger=a.logger??new Us,this.cache=a.cache??new cs}static[h]="SQLiteD1Session";logger;cache;prepareQuery(e,t,n,a,r,i,l){const d=this.client.prepare(e.sql);return new Qa(d,e,this.logger,this.cache,i,l,t,n,a,r)}async batch(e){const t=[],n=[];for(const r of e){const i=r._prepare(),l=i.getQuery();if(t.push(i),l.params.length>0)n.push(i.stmt.bind(...l.params));else{const d=i.getQuery();n.push(this.client.prepare(d.sql).bind(...d.params))}}return(await this.client.batch(n)).map((r,i)=>t[i].mapResult(r,!0))}extractRawAllValueFromBatchResult(e){return e.results}extractRawGetValueFromBatchResult(e){return e.results[0]}extractRawValuesValueFromBatchResult(e){return vt(e.results)}async transaction(e,t){const n=new At("async",this.dialect,this,this.schema);await this.run(c.raw(`begin${t?.behavior?" "+t.behavior:""}`));try{const a=await e(n);return await this.run(c`commit`),a}catch(a){throw await this.run(c`rollback`),a}}}class At extends Ta{static[h]="D1Transaction";async transaction(e){const t=`sp${this.nestedIndex}`,n=new At("async",this.dialect,this.session,this.schema,this.nestedIndex+1);await this.session.run(c.raw(`savepoint ${t}`));try{const a=await e(n);return await this.session.run(c.raw(`release savepoint ${t}`)),a}catch(a){throw await this.session.run(c.raw(`rollback to savepoint ${t}`)),a}}}function vt(s){const e=[];for(const t of s){const n=Object.keys(t).map(a=>t[a]);e.push(n)}return e}class Qa extends _a{constructor(e,t,n,a,r,i,l,d,f,u){super("async",d,t,a,r,i),this.logger=n,this._isResponseInArrayMode=f,this.customResultMapper=u,this.fields=l,this.stmt=e}static[h]="D1PreparedQuery";customResultMapper;fields;stmt;async run(e){const t=Ke(this.query.params,e??{});return this.logger.logQuery(this.query.sql,t),await this.queryWithCache(this.query.sql,t,async()=>this.stmt.bind(...t).run())}async all(e){const{fields:t,query:n,logger:a,stmt:r,customResultMapper:i}=this;if(!t&&!i){const d=Ke(n.params,e??{});return a.logQuery(n.sql,d),await this.queryWithCache(n.sql,d,async()=>r.bind(...d).all().then(({results:f})=>this.mapAllResult(f)))}const l=await this.values(e);return this.mapAllResult(l)}mapAllResult(e,t){return t&&(e=vt(e.results)),!this.fields&&!this.customResultMapper?e:this.customResultMapper?this.customResultMapper(e):e.map(n=>ct(this.fields,n,this.joinsNotNullableMap))}async get(e){const{fields:t,joinsNotNullableMap:n,query:a,logger:r,stmt:i,customResultMapper:l}=this;if(!t&&!l){const f=Ke(a.params,e??{});return r.logQuery(a.sql,f),await this.queryWithCache(a.sql,f,async()=>i.bind(...f).all().then(({results:u})=>u[0]))}const d=await this.values(e);if(d[0])return l?l(d):ct(t,d[0],n)}mapGetResult(e,t){return t&&(e=vt(e.results)[0]),!this.fields&&!this.customResultMapper?e:this.customResultMapper?this.customResultMapper([e]):ct(this.fields,e,this.joinsNotNullableMap)}async values(e){const t=Ke(this.query.params,e??{});return this.logger.logQuery(this.query.sql,t),await this.queryWithCache(this.query.sql,t,async()=>this.stmt.bind(...t).raw())}isResponseInArrayMode(){return this._isResponseInArrayMode}}class Ba extends os{static[h]="D1Database";async batch(e){return this.session.batch(e)}}function $a(s,e={}){const t=new ma({casing:e.casing});let n;e.logger===!0?n=new js:e.logger!==!1&&(n=e.logger);let a;if(e.schema){const l=gn(e.schema,Sn);a={fullSchema:e.schema,schema:l.tables,tableNamesMap:l.tableNamesMap}}const r=new Aa(s,t,a,{logger:n,cache:e.cache}),i=new Ba("async",t,r,a);return i.$client=s,i.$cache=e.cache,i.$cache&&(i.$cache.invalidate=e.cache?.onMutate),i}function ee(s){return $a(s)}const ye=Qe("users",{id:E("id").primaryKey(),name:E("name").notNull()}),z=Qe("boards",{id:E("id").primaryKey(),title:E("title").notNull(),description:E("description"),createdAt:fe("created_at",{mode:"timestamp"}).notNull().$defaultFn(()=>new Date)}),se=Qe("lists",{id:E("id").primaryKey(),boardId:E("board_id").notNull().references(()=>z.id,{onDelete:"cascade"}),title:E("title").notNull(),position:fe("position").notNull(),createdAt:fe("created_at",{mode:"timestamp"}).notNull().$defaultFn(()=>new Date)},s=>({boardIdIdx:oe("lists_board_id_idx").on(s.boardId),positionIdx:oe("lists_position_idx").on(s.position)})),B=Qe("cards",{id:E("id").primaryKey(),listId:E("list_id").notNull().references(()=>se.id,{onDelete:"cascade"}),title:E("title").notNull(),description:E("description"),assigneeId:E("assignee_id").references(()=>ye.id,{onDelete:"set null"}),position:fe("position").notNull(),completed:fe("completed",{mode:"boolean"}).default(!1),createdAt:fe("created_at",{mode:"timestamp"}).notNull().$defaultFn(()=>new Date)},s=>({listIdIdx:oe("cards_list_id_idx").on(s.listId),positionIdx:oe("cards_position_idx").on(s.position),assigneeIdx:oe("cards_assignee_id_idx").on(s.assigneeId)})),H=Qe("tags",{id:E("id").primaryKey(),name:E("name").notNull(),color:E("color").notNull(),createdAt:fe("created_at",{mode:"timestamp"}).notNull().$defaultFn(()=>new Date)}),X=Qe("card_tags",{cardId:E("card_id").notNull().references(()=>B.id,{onDelete:"cascade"}),tagId:E("tag_id").notNull().references(()=>H.id,{onDelete:"cascade"})},s=>({pk:la({columns:[s.cardId,s.tagId]}),cardIdIdx:oe("card_tags_card_id_idx").on(s.cardId),tagIdIdx:oe("card_tags_tag_id_idx").on(s.tagId)})),re=Qe("comments",{id:E("id").primaryKey(),cardId:E("card_id").notNull().references(()=>B.id,{onDelete:"cascade"}),userId:E("user_id").notNull().references(()=>ye.id,{onDelete:"set null"}),text:E("text").notNull(),createdAt:fe("created_at",{mode:"timestamp"}).notNull().$defaultFn(()=>new Date)},s=>({cardIdIdx:oe("comments_card_id_idx").on(s.cardId),userIdIdx:oe("comments_user_id_idx").on(s.userId),createdAtIdx:oe("comments_created_at_idx").on(s.createdAt)}));async function Da(s){return await ee(s).select({id:z.id,title:z.title,description:z.description}).from(z).orderBy(Ie(z.createdAt))}async function Ea(s,e){const t=ee(s),a=(await t.select({id:z.id,title:z.title,description:z.description}).from(z).where(Z(z.id,e)))[0];if(!a)return null;const r=await t.select({id:se.id,title:se.title,position:se.position}).from(se).where(Z(se.boardId,e)).orderBy(Ie(se.position));if(r.length===0)return{...a,lists:[]};const i=r.map(S=>S.id),l=await t.select({id:B.id,title:B.title,description:B.description,position:B.position,completed:B.completed,assigneeId:B.assigneeId,listId:B.listId}).from(B).where(We(B.listId,i)).orderBy(Ie(B.position)),d=l.map(S=>S.id),f=d.length?await t.select({cardId:X.cardId,tagId:H.id,tagName:H.name,tagColor:H.color}).from(X).innerJoin(H,Z(X.tagId,H.id)).where(We(X.cardId,d)):[],u=d.length?await t.select({id:re.id,cardId:re.cardId,userId:re.userId,text:re.text,createdAt:re.createdAt}).from(re).where(We(re.cardId,d)).orderBy(Ie(re.createdAt)):[],p=new Map;for(const S of f){const x=p.get(S.cardId),C={id:S.tagId,name:S.tagName,color:S.tagColor};x?x.push(C):p.set(S.cardId,[C])}const v=new Map;for(const S of u){const x={id:S.id,userId:S.userId,text:S.text,createdAt:S.createdAt},C=v.get(S.cardId);C?C.push(x):v.set(S.cardId,[x])}return{...a,lists:r.map(S=>({...S,cards:l.filter(x=>x.listId===S.id).map(x=>({id:x.id,title:x.title,description:x.description,position:x.position,completed:x.completed,assigneeId:x.assigneeId,tags:p.get(x.id)??[],comments:v.get(x.id)??[]}))}))}}async function Oa(s){return ee(s).select({id:ye.id,name:ye.name}).from(ye).orderBy(Ie(ye.name))}async function qa(s){return ee(s).select({id:H.id,name:H.name,color:H.color}).from(H).orderBy(Ie(H.name))}const Ra=({track:s})=>{const[e,t]=_();s(t.isOpen)},Fa=()=>{const[s]=_();s.isOpen.value=!1},Pa=async s=>{const[e]=_(),t=s.target,n=new FormData(t),a=n.get("title"),r=n.get("description"),i=await e.action.submit(n);i.value?.success&&i.value.boardId&&e.onBoardAdd&&(e.onBoardAdd({id:i.value.boardId,title:a,description:r||null}),e.isOpen.value=!1,t.reset())},Ma=s=>{const e=K();Ce(y(Ra,"s_zqsx26q8588",[e,s]));const t=y(Fa,"s_IXHTv75Wlvs",[s]),n=y(Pa,"s_CgjnTd6KtXI",[s]);return O(Me,{children:o("dialog",{ref:e},{open:g(a=>a.isOpen.value,[s],"p0.isOpen.value"),class:"modal !mt-0",onClick$:me("s_eyyhQ9LkU94",[t])},[o("div",null,{class:"modal-backdrop bg-black/70"},null,3,null),o("div",null,{class:"modal-box bg-base-200 dark:bg-base-300"},o("form",null,{method:"dialog","preventdefault:submit":!0,onSubmit$:n},[o("button",null,{type:"button",class:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2",onClick$:t},"",3,null),o("h3",null,{class:"font-bold text-lg mb-4"},"Add New Board",3,null),o("div",null,{class:"form-control w-full mb-4"},[o("label",null,{class:"label"},o("span",null,{class:"label-text"},"Title",3,null),3,null),o("input",null,{type:"text",name:"title",class:"input input-bordered w-full",placeholder:"Enter board title"},null,3,null)],3,null),o("div",null,{class:"form-control w-full mb-4"},[o("label",null,{class:"label"},o("span",null,{class:"label-text"},"Description",3,null),3,null),o("textarea",null,{name:"description",class:"textarea textarea-bordered h-24 w-full",placeholder:"Enter board description (optional)"},null,3,null)],3,null),o("div",null,{class:"modal-action"},[o("button",null,{type:"button",class:"btn btn-ghost",onClick$:t},"Cancel",3,null),o("button",null,{type:"submit",class:"btn btn-primary",disabled:g(a=>a.action.isRunning,[s],"p0.action.isRunning")},g(a=>a.action.isRunning?"Creating...":"Add Board",[s],'p0.action.isRunning?"Creating...":"Add Board"'),3,null)],3,null),s.action.value?.error&&o("div",null,{class:"alert alert-error mt-4"},o("span",null,null,g(a=>a.action.value.error,[s],"p0.action.value.error"),3,null),3,"Xc_0")],1,null),1,null)],1,null)},1,"Xc_1")},ja=W(y(Ma,"s_7XKboceZpJY"));var dt;function ds(s){return{lang:s?.lang??dt?.lang,message:s?.message,abortEarly:s?.abortEarly??dt?.abortEarly,abortPipeEarly:s?.abortPipeEarly??dt?.abortPipeEarly}}var Ua;function ka(s){return Ua?.get(s)}var Ka;function za(s){return Ka?.get(s)}var Va;function Ja(s,e){return Va?.get(s)?.get(e)}function Wa(s){const e=typeof s;return e==="string"?`"${s}"`:e==="number"||e==="bigint"||e==="boolean"?`${s}`:e==="object"||e==="function"?(s&&Object.getPrototypeOf(s)?.constructor?.name)??"null":e}function Ne(s,e,t,n,a){const r=a&&"input"in a?a.input:t.value,i=a?.expected??s.expects??null,l=a?.received??Wa(r),d={kind:s.kind,type:s.type,input:r,expected:i,received:l,message:`Invalid ${e}: ${i?`Expected ${i} but r`:"R"}eceived ${l}`,requirement:s.requirement,path:a?.path,issues:a?.issues,lang:n.lang,abortEarly:n.abortEarly,abortPipeEarly:n.abortPipeEarly},f=s.kind==="schema",u=a?.message??s.message??Ja(s.reference,d.lang)??(f?za(d.lang):null)??n.message??ka(d.lang);u!==void 0&&(d.message=typeof u=="function"?u(d):u),f&&(t.typed=!1),t.issues?t.issues.push(d):t.issues=[d]}function Fe(s){return{version:1,vendor:"valibot",validate(e){return s["~run"]({value:e},ds())}}}function Se(s,e){return{kind:"validation",type:"max_length",reference:Se,async:!1,expects:`<=${s}`,requirement:s,message:e,"~run"(t,n){return t.typed&&t.value.length>this.requirement&&Ne(this,"length",t,n,{received:`${t.value.length}`}),t}}}function Te(s,e){return{kind:"validation",type:"min_length",reference:Te,async:!1,expects:`>=${s}`,requirement:s,message:e,"~run"(t,n){return t.typed&&t.value.length<this.requirement&&Ne(this,"length",t,n,{received:`${t.value.length}`}),t}}}function Ya(s,e,t){return typeof s.fallback=="function"?s.fallback(e,t):s.fallback}function us(s,e,t){return typeof s.default=="function"?s.default(e,t):s.default}function Qt(s,e){return{kind:"schema",type:"array",reference:Qt,expects:"Array",async:!1,item:s,message:e,get"~standard"(){return Fe(this)},"~run"(t,n){const a=t.value;if(Array.isArray(a)){t.typed=!0,t.value=[];for(let r=0;r<a.length;r++){const i=a[r],l=this.item["~run"]({value:i},n);if(l.issues){const d={type:"array",origin:"value",input:a,key:r,value:i};for(const f of l.issues)f.path?f.path.unshift(d):f.path=[d],t.issues?.push(f);if(t.issues||(t.issues=l.issues),n.abortEarly){t.typed=!1;break}}l.typed||(t.typed=!1),t.value.push(l.value)}}else Ne(this,"type",t,n);return t}}}function Bt(s){return{kind:"schema",type:"number",reference:Bt,expects:"number",async:!1,message:s,get"~standard"(){return Fe(this)},"~run"(e,t){return typeof e.value=="number"&&!isNaN(e.value)?e.typed=!0:Ne(this,"type",e,t),e}}}function Be(s,e){return{kind:"schema",type:"object",reference:Be,expects:"Object",async:!1,entries:s,message:e,get"~standard"(){return Fe(this)},"~run"(t,n){const a=t.value;if(a&&typeof a=="object"){t.typed=!0,t.value={};for(const r in this.entries){const i=this.entries[r];if(r in a||(i.type==="exact_optional"||i.type==="optional"||i.type==="nullish")&&i.default!==void 0){const l=r in a?a[r]:us(i),d=i["~run"]({value:l},n);if(d.issues){const f={type:"object",origin:"value",input:a,key:r,value:l};for(const u of d.issues)u.path?u.path.unshift(f):u.path=[f],t.issues?.push(u);if(t.issues||(t.issues=d.issues),n.abortEarly){t.typed=!1;break}}d.typed||(t.typed=!1),t.value[r]=d.value}else if(i.fallback!==void 0)t.value[r]=Ya(i);else if(i.type!=="exact_optional"&&i.type!=="optional"&&i.type!=="nullish"&&(Ne(this,"key",t,n,{input:void 0,expected:`"${r}"`,path:[{type:"object",origin:"key",input:a,key:r,value:a[r]}]}),n.abortEarly))break}}else Ne(this,"type",t,n);return t}}}function qe(s,e){return{kind:"schema",type:"optional",reference:qe,expects:`(${s.expects} | undefined)`,async:!1,wrapped:s,default:e,get"~standard"(){return Fe(this)},"~run"(t,n){return t.value===void 0&&(this.default!==void 0&&(t.value=us(this,t,n)),t.value===void 0)?(t.typed=!0,t):this.wrapped["~run"](t,n)}}}function F(s){return{kind:"schema",type:"string",reference:F,expects:"string",async:!1,message:s,get"~standard"(){return Fe(this)},"~run"(e,t){return typeof e.value=="string"?e.typed=!0:Ne(this,"type",e,t),e}}}function he(...s){return{...s[0],pipe:s,get"~standard"(){return Fe(this)},"~run"(e,t){for(const n of s)if(n.kind!=="metadata"){if(e.issues&&(n.kind==="schema"||n.kind==="transformation")){e.typed=!1;break}(!e.issues||!t.abortEarly&&!t.abortPipeEarly)&&(e=n["~run"](e,t))}return e}}}function $e(s,e,t){const n=s["~run"]({value:e},ds(t));return{typed:n.typed,success:!n.issues,output:n.value,issues:n.issues}}const Ha=Be({title:he(F("Title is required"),Te(1,"Title cannot be empty"),Se(255,"Title must be less than 255 characters")),description:qe(he(F(),Se(500,"Description must be less than 500 characters")))}),Xa=Be({title:he(F("Title is required"),Te(1,"Title cannot be empty"),Se(255,"Title must be less than 255 characters")),description:qe(he(F(),Se(2e3,"Description must be less than 2000 characters"))),assigneeId:he(F("Assignee is required"),Te(1,"Assignee is required")),tagIds:qe(Qt(F()))}),Za=Be({cardId:F("Card ID is required"),title:he(F("Title is required"),Te(1,"Title cannot be empty"),Se(255,"Title must be less than 255 characters")),description:qe(he(F(),Se(2e3,"Description must be less than 2000 characters"))),assigneeId:he(F("Assignee is required"),Te(1,"Assignee is required")),tagIds:qe(Qt(F()))}),Ga=Be({cardId:F("Card ID is required"),userId:F("User ID is required"),text:he(F("Comment text is required"),Te(1,"Comment text cannot be empty"),Se(1e3,"Comment must be less than 1000 characters"))}),fs=Be({cardId:F("Card ID is required"),listId:F("List ID is required"),newPosition:Bt("A valid position is required")}),er=Be({cardId:F("Card ID is required"),position:Bt("A valid position is required")}),tr=async({platform:s})=>{const e=s.env?.DB;return await Da(e)},hs=tt(y(tr,"s_O3FJtMKpl6c")),sr=async(s,{platform:e})=>{try{const t=e.env?.DB,n=ee(t),a=$e(Ha,{title:s.title,description:s.description||null});if(!a.success)return{success:!1,error:a.issues[0]?.message??"Invalid board data"};const r=a.output,i=crypto.randomUUID();await n.insert(z).values({id:i,title:r.title,description:r.description??null});const l=["Todo","In-Progress","QA","Done"];return await n.insert(se).values(l.map((d,f)=>({id:crypto.randomUUID(),boardId:i,title:d,position:f}))),{success:!0,boardId:i}}catch(t){return console.error("Failed to create board:",t),{success:!1,error:t instanceof Error?t.message:"Failed to create board. Please try again."}}},ms=be(y(sr,"s_Z0pU7Ja7LCQ")),nr=({track:s})=>{const[e,t]=_(),n=s(e);n&&(t.value=n)},ar=()=>{const[s]=_();return[...s.value].sort((e,t)=>e.title.localeCompare(t.title))},rr=s=>{const[e]=_(),t={id:s.id,title:s.title,description:s.description};e.value=[...e.value,t]},ir=()=>{const s=hs(),e=ms(),t=K(!1),n=K(s.value);Ce(y(nr,"s_yxtomTAcFP0",[s,n]));const a=Ye(y(ar,"s_QWZOu0S7SL8",[n])),r=y(rr,"s_FR9W3pqtT0A",[n]);return o("main",null,{class:"w-full max-w-4xl mx-auto p-8 space-y-10 rounded-[2.5rem] bg-base-100 dark:bg-base-200 shadow-xl"},[o("header",null,{class:"text-center space-y-3"},[o("p",null,{class:"text-sm uppercase tracking-wide text-secondary"},"Your workspace",3,null),o("h1",null,{class:"text-4xl font-black text-primary"},"Boards",3,null),o("p",null,{class:"text-base text-base-content/60"},"Choose a board to jump into your Kanban flow.",3,null)],3,null),o("div",null,{class:"flex justify-end"},o("button",null,{type:"button",class:"btn btn-primary",onClick$:me("s_Fo98gNuN8bo",[t])},"Add Board",3,null),3,null),o("section",null,{class:"grid gap-8 md:grid-cols-2"},a.value.length===0?o("div",null,{class:"card bg-base-200 dark:bg-base-300 shadow-xl"},o("div",null,{class:"card-body items-center text-center"},[o("h2",null,{class:"card-title text-secondary"},"No boards yet",3,null),o("p",null,{class:"text-base-content/60"},"Create your first board to get started.",3,null)],3,null),3,"i8_0"):a.value.map(i=>O(ft,{href:`/board/${i.id}`,class:"card bg-base-200 dark:bg-base-300 shadow-xl hover:shadow-2xl hover:scale-[1.02] transition-all",children:o("div",null,{class:"card-body"},[o("h2",null,{class:"card-title text-primary"},G(i,"title"),1,null),i.description?o("p",null,{class:"text-sm text-base-content/60"},G(i,"description"),1,"i8_1"):o("p",null,{class:"badge badge-secondary badge-outline w-fit shadow"},"No description",3,null),o("div",null,{class:"card-actions justify-end"},o("span",null,{class:"btn btn-secondary btn-sm shadow-lg"},"Open board",3,null),3,null)],1,null),[L]:{class:L}},1,i.id)),1,null),O(ja,{isOpen:t,action:e,onBoardAdd:r,[L]:{isOpen:L,action:L,onBoardAdd:L}},3,"i8_2")],1,"i8_3")},lr=W(y(ir,"s_B0lqk5IDDy4")),or={title:"Kanban Boards",meta:[{name:"description",content:"Manage your Kanban boards and organize your tasks"}]},cr=Object.freeze(Object.defineProperty({__proto__:null,default:lr,head:or,useBoards:hs,useCreateBoardAction:ms},Symbol.toStringTag,{value:"Module"})),dr=async({json:s,platform:e})=>{try{const t=e.env?.DB;if(!t){s(500,{error:"D1 binding not found"});return}console.log("[Migrate] Applying schema..."),await t.batch([t.prepare('CREATE TABLE IF NOT EXISTS "users" ("id" text PRIMARY KEY NOT NULL, "name" text NOT NULL)'),t.prepare('CREATE TABLE IF NOT EXISTS "boards" ("id" text PRIMARY KEY NOT NULL, "title" text NOT NULL, "description" text, "created_at" integer DEFAULT (unixepoch() * 1000) NOT NULL)'),t.prepare('CREATE TABLE IF NOT EXISTS "lists" ("id" text PRIMARY KEY NOT NULL, "board_id" text NOT NULL, "title" text NOT NULL, "position" integer NOT NULL, "created_at" integer DEFAULT (unixepoch() * 1000) NOT NULL, FOREIGN KEY ("board_id") REFERENCES "boards"("id") ON UPDATE no action ON DELETE cascade)'),t.prepare('CREATE TABLE IF NOT EXISTS "cards" ("id" text PRIMARY KEY NOT NULL, "list_id" text NOT NULL, "title" text NOT NULL, "description" text, "assignee_id" text, "position" integer NOT NULL, "completed" integer DEFAULT 0 NOT NULL, "created_at" integer DEFAULT (unixepoch() * 1000) NOT NULL, FOREIGN KEY ("list_id") REFERENCES "lists"("id") ON UPDATE no action ON DELETE cascade, FOREIGN KEY ("assignee_id") REFERENCES "users"("id") ON UPDATE no action ON DELETE set null)'),t.prepare('CREATE TABLE IF NOT EXISTS "tags" ("id" text PRIMARY KEY NOT NULL, "name" text NOT NULL, "color" text NOT NULL, "created_at" integer DEFAULT (unixepoch() * 1000) NOT NULL)'),t.prepare('CREATE TABLE IF NOT EXISTS "card_tags" ("card_id" text NOT NULL, "tag_id" text NOT NULL, PRIMARY KEY("card_id","tag_id"), FOREIGN KEY ("card_id") REFERENCES "cards"("id") ON UPDATE no action ON DELETE cascade, FOREIGN KEY ("tag_id") REFERENCES "tags"("id") ON UPDATE no action ON DELETE cascade)'),t.prepare('CREATE TABLE IF NOT EXISTS "comments" ("id" text PRIMARY KEY NOT NULL, "card_id" text NOT NULL, "user_id" text NOT NULL, "text" text NOT NULL, "created_at" integer DEFAULT (unixepoch() * 1000) NOT NULL, FOREIGN KEY ("card_id") REFERENCES "cards"("id") ON UPDATE no action ON DELETE cascade, FOREIGN KEY ("user_id") REFERENCES "users"("id") ON UPDATE no action ON DELETE set null)')]),console.log("[Migrate] Schema applied successfully"),s(200,{success:!0,message:"Database schema applied successfully"})}catch(t){console.error("[Migrate] Error:",t),s(500,{error:"Failed to apply schema",details:t instanceof Error?t.message:"Unknown error"})}},ur=Object.freeze(Object.defineProperty({__proto__:null,onPost:dr},Symbol.toStringTag,{value:"Module"})),$=(s,e,t=0)=>new Date(Date.UTC(2024,0,s,e,t)),zt=[{id:"2cd5fecb-eee6-4cd1-8639-1f634b900a3b",name:"Loren"},{id:"ce642ef6-6367-406e-82ea-b0236361440f",name:"Alex"},{id:"288bc717-a551-4a91-8d9d-444d13addb68",name:"Dolly"},{id:"9689b595-abe1-4589-838c-1958aae53a94",name:"Bobby"},{id:"6ef2bf51-f656-49ac-843f-5954a6f2a00b",name:"Sofia"}],St=[{id:"b05927a0-76d2-42d5-8ad3-a1b93c39698c",title:"Product Launch",description:"Launch prep checklist",createdAt:$(1,9)},{id:"2b126cd1-627d-489f-81e9-2868305f1945",title:"Website Refresh",description:"Marketing site overhaul",createdAt:$(1,10)}],fr=["Todo","In-Progress","QA","Done"],hr=[["7e331af8-1641-4d2b-81e8-1b23085d17fe","3ce313c4-7ad5-4e24-896f-9609dfc35dd0","29d2b707-41d9-42a9-8d13-9f5380add228","5fb8a343-78f7-4891-85fa-5a17db87151c"],["22202c8e-3976-4775-8832-8bc3961d8fed","cf98cc8a-e59a-4590-8fcd-f1d89a8975c8","089da10e-c76a-4ff6-8928-fd352a3ddd04","42047e01-87ea-4ec6-8ec2-d539b10b3c64"]],xt=St.flatMap((s,e)=>fr.map((t,n)=>({id:hr[e][n],boardId:s.id,title:t,position:n+1,createdAt:$(2+e,8+n)}))),bs=new Map;for(const s of xt)bs.set(`${s.boardId}:${s.title}`,s.id);const M=(s,e)=>{const t=bs.get(`${s}:${e}`);if(!t)throw new Error(`Missing list for ${s} ${e}`);return t},ut=[{id:"4c01f11d-3c41-414f-83b2-5e9bba2cefa6",listId:M("b05927a0-76d2-42d5-8ad3-a1b93c39698c","Todo"),title:"Draft product brief",description:"Summarize goals and success metrics.",assigneeId:"2cd5fecb-eee6-4cd1-8639-1f634b900a3b",position:1,completed:!1,createdAt:$(4,9)},{id:"f3a93a34-956e-43cd-8d7a-acae880153f2",listId:M("b05927a0-76d2-42d5-8ad3-a1b93c39698c","Todo"),title:"Complete market research",description:"Compile competitor landscape report.",assigneeId:"288bc717-a551-4a91-8d9d-444d13addb68",position:2,completed:!1,createdAt:$(4,10)},{id:"21f71319-8641-42bb-8e3c-b9002fed25a4",listId:M("b05927a0-76d2-42d5-8ad3-a1b93c39698c","In-Progress"),title:"Build demo environment",description:"Set up walkthrough environment with sample data.",assigneeId:"ce642ef6-6367-406e-82ea-b0236361440f",position:1,completed:!1,createdAt:$(4,11)},{id:"d3d8171c-5025-4cff-88d6-2542ae13f2d3",listId:M("b05927a0-76d2-42d5-8ad3-a1b93c39698c","In-Progress"),title:"Assemble sales kit",description:"Draft enablement materials for sales team.",assigneeId:"9689b595-abe1-4589-838c-1958aae53a94",position:2,completed:!1,createdAt:$(4,12)},{id:"5868fe01-1f50-4e22-808c-276c8a884a61",listId:M("b05927a0-76d2-42d5-8ad3-a1b93c39698c","QA"),title:"Validate QA checklist",description:"Verify release criteria with QA leads.",assigneeId:"6ef2bf51-f656-49ac-843f-5954a6f2a00b",position:1,completed:!1,createdAt:$(4,13)},{id:"bc98f392-ca0b-4842-8f58-2b14d3959f04",listId:M("b05927a0-76d2-42d5-8ad3-a1b93c39698c","QA"),title:"Schedule executive sign-off",description:"Coordinate leadership review session.",assigneeId:"2cd5fecb-eee6-4cd1-8639-1f634b900a3b",position:2,completed:!1,createdAt:$(4,14)},{id:"5125d378-d1e4-4be3-8f92-df5e7115a160",listId:M("b05927a0-76d2-42d5-8ad3-a1b93c39698c","Done"),title:"Document kickoff notes",description:"Capture key decisions from project kickoff.",assigneeId:"ce642ef6-6367-406e-82ea-b0236361440f",position:1,completed:!0,createdAt:$(3,9)},{id:"8808dae4-ad94-46b5-89db-46edb52efe13",listId:M("b05927a0-76d2-42d5-8ad3-a1b93c39698c","Done"),title:"Record budget approval",description:"Log finance approval confirmation.",assigneeId:"288bc717-a551-4a91-8d9d-444d13addb68",position:2,completed:!0,createdAt:$(3,10)},{id:"0b20a227-1243-4403-8df8-db7a1db1770d",listId:M("2b126cd1-627d-489f-81e9-2868305f1945","Todo"),title:"Create homepage wireframes",description:"Prepare wireframes for hero, features, and pricing.",assigneeId:"6ef2bf51-f656-49ac-843f-5954a6f2a00b",position:1,completed:!1,createdAt:$(5,9)},{id:"d4e075b0-5c97-4b3f-893f-e5cced11c9f8",listId:M("2b126cd1-627d-489f-81e9-2868305f1945","Todo"),title:"Research SEO keywords",description:"Finalize target keywords for new pages.",assigneeId:"9689b595-abe1-4589-838c-1958aae53a94",position:2,completed:!1,createdAt:$(5,10)},{id:"29a6974d-db06-45ea-8edf-af9aba1ed799",listId:M("2b126cd1-627d-489f-81e9-2868305f1945","In-Progress"),title:"Design homepage hero",description:"Produce responsive hero assets.",assigneeId:"ce642ef6-6367-406e-82ea-b0236361440f",position:1,completed:!1,createdAt:$(5,11)},{id:"be948ffa-eb48-4a0d-850a-c6d2c36d852d",listId:M("2b126cd1-627d-489f-81e9-2868305f1945","In-Progress"),title:"Integrate CMS content",description:"Populate CMS entries for refreshed pages.",assigneeId:"2cd5fecb-eee6-4cd1-8639-1f634b900a3b",position:2,completed:!1,createdAt:$(5,12)},{id:"dba9e06c-588a-478f-8e7f-51e3c1d6eb06",listId:M("2b126cd1-627d-489f-81e9-2868305f1945","QA"),title:"Run responsive QA",description:"Validate layouts across breakpoints.",assigneeId:"288bc717-a551-4a91-8d9d-444d13addb68",position:1,completed:!1,createdAt:$(5,13)},{id:"d1d6a5bd-c3b2-4faf-87f2-9068ce9f98bb",listId:M("2b126cd1-627d-489f-81e9-2868305f1945","QA"),title:"Complete accessibility audit",description:"Review accessibility checklist and fix issues.",assigneeId:"6ef2bf51-f656-49ac-843f-5954a6f2a00b",position:2,completed:!1,createdAt:$(5,14)},{id:"8c2240ed-194f-4a1e-8bab-0a7030ac56ce",listId:M("2b126cd1-627d-489f-81e9-2868305f1945","Done"),title:"Update style guide",description:"Publish revised color and typography tokens.",assigneeId:"ce642ef6-6367-406e-82ea-b0236361440f",position:1,completed:!0,createdAt:$(4,8)},{id:"f4136567-ba8b-4c4a-8128-212e159aa59f",listId:M("2b126cd1-627d-489f-81e9-2868305f1945","Done"),title:"Confirm analytics setup",description:"Verify dashboards reflect new pages.",assigneeId:"9689b595-abe1-4589-838c-1958aae53a94",position:2,completed:!0,createdAt:$(4,9)}],Vt=[{id:"bf87f479-2a05-4fe8-8122-22afa5e30141",name:"Design",color:"#8B5CF6",createdAt:$(1,12)},{id:"3b8bff79-df12-4e14-860b-3e2cebe73cff",name:"Product",color:"#EC4899",createdAt:$(1,13)},{id:"68421280-45b2-4276-8e4c-9dfc33a349f0",name:"Engineering",color:"#3B82F6",createdAt:$(1,14)},{id:"14415f32-16aa-4860-87ef-636a7f0dd47f",name:"Marketing",color:"#10B981",createdAt:$(1,15)},{id:"828ba03d-c9b4-402c-8165-59cb9f67d30f",name:"QA",color:"#F59E0B",createdAt:$(1,16)}],Jt=[{cardId:"4c01f11d-3c41-414f-83b2-5e9bba2cefa6",tagId:"3b8bff79-df12-4e14-860b-3e2cebe73cff"},{cardId:"4c01f11d-3c41-414f-83b2-5e9bba2cefa6",tagId:"14415f32-16aa-4860-87ef-636a7f0dd47f"},{cardId:"f3a93a34-956e-43cd-8d7a-acae880153f2",tagId:"14415f32-16aa-4860-87ef-636a7f0dd47f"},{cardId:"21f71319-8641-42bb-8e3c-b9002fed25a4",tagId:"68421280-45b2-4276-8e4c-9dfc33a349f0"},{cardId:"d3d8171c-5025-4cff-88d6-2542ae13f2d3",tagId:"3b8bff79-df12-4e14-860b-3e2cebe73cff"},{cardId:"d3d8171c-5025-4cff-88d6-2542ae13f2d3",tagId:"14415f32-16aa-4860-87ef-636a7f0dd47f"},{cardId:"5868fe01-1f50-4e22-808c-276c8a884a61",tagId:"828ba03d-c9b4-402c-8165-59cb9f67d30f"},{cardId:"bc98f392-ca0b-4842-8f58-2b14d3959f04",tagId:"3b8bff79-df12-4e14-860b-3e2cebe73cff"},{cardId:"5125d378-d1e4-4be3-8f92-df5e7115a160",tagId:"3b8bff79-df12-4e14-860b-3e2cebe73cff"},{cardId:"8808dae4-ad94-46b5-89db-46edb52efe13",tagId:"3b8bff79-df12-4e14-860b-3e2cebe73cff"},{cardId:"0b20a227-1243-4403-8df8-db7a1db1770d",tagId:"bf87f479-2a05-4fe8-8122-22afa5e30141"},{cardId:"d4e075b0-5c97-4b3f-893f-e5cced11c9f8",tagId:"14415f32-16aa-4860-87ef-636a7f0dd47f"},{cardId:"29a6974d-db06-45ea-8edf-af9aba1ed799",tagId:"bf87f479-2a05-4fe8-8122-22afa5e30141"},{cardId:"29a6974d-db06-45ea-8edf-af9aba1ed799",tagId:"3b8bff79-df12-4e14-860b-3e2cebe73cff"},{cardId:"be948ffa-eb48-4a0d-850a-c6d2c36d852d",tagId:"68421280-45b2-4276-8e4c-9dfc33a349f0"},{cardId:"dba9e06c-588a-478f-8e7f-51e3c1d6eb06",tagId:"828ba03d-c9b4-402c-8165-59cb9f67d30f"},{cardId:"d1d6a5bd-c3b2-4faf-87f2-9068ce9f98bb",tagId:"828ba03d-c9b4-402c-8165-59cb9f67d30f"},{cardId:"8c2240ed-194f-4a1e-8bab-0a7030ac56ce",tagId:"bf87f479-2a05-4fe8-8122-22afa5e30141"},{cardId:"f4136567-ba8b-4c4a-8128-212e159aa59f",tagId:"68421280-45b2-4276-8e4c-9dfc33a349f0"},{cardId:"f4136567-ba8b-4c4a-8128-212e159aa59f",tagId:"14415f32-16aa-4860-87ef-636a7f0dd47f"}],T=(s,e,t,n,a,r,i=0)=>({id:s,cardId:e,userId:t,text:n,createdAt:$(a,r,i)}),Wt=[T("ca17e81b-9e6c-47e8-8901-c6fe3e4d9431","4c01f11d-3c41-414f-83b2-5e9bba2cefa6","2cd5fecb-eee6-4cd1-8639-1f634b900a3b","Initial outline drafted.",6,9),T("2b2c02a8-0467-4b11-8d99-82776b3bb686","4c01f11d-3c41-414f-83b2-5e9bba2cefa6","ce642ef6-6367-406e-82ea-b0236361440f","Review scheduled for tomorrow.",6,11),T("74aa8194-0691-4591-8c0c-5dc219c6c67a","f3a93a34-956e-43cd-8d7a-acae880153f2","288bc717-a551-4a91-8d9d-444d13addb68","Collected competitor pricing.",6,12),T("8d8b25e9-9e7a-4ee0-86a2-df1b197008e4","f3a93a34-956e-43cd-8d7a-acae880153f2","9689b595-abe1-4589-838c-1958aae53a94","Will add win-loss insights.",6,14),T("eaa05186-35b4-4511-81d1-6d8ae6784b55","21f71319-8641-42bb-8e3c-b9002fed25a4","ce642ef6-6367-406e-82ea-b0236361440f","Demo environment bootstrapped.",6,10),T("b098967a-1f69-4c3a-8d10-ac3216a99209","21f71319-8641-42bb-8e3c-b9002fed25a4","6ef2bf51-f656-49ac-843f-5954a6f2a00b","QA will test walkthrough.",6,12),T("4a1f8db8-f098-4a97-8618-d6c97b6dbd74","d3d8171c-5025-4cff-88d6-2542ae13f2d3","9689b595-abe1-4589-838c-1958aae53a94","Draft slides uploaded.",6,13),T("c142d2d0-6bb5-4892-8284-7c688e840ebb","d3d8171c-5025-4cff-88d6-2542ae13f2d3","2cd5fecb-eee6-4cd1-8639-1f634b900a3b","Adding launch messaging.",6,15),T("bc7390ea-74de-4e8f-886c-91bced77048b","5868fe01-1f50-4e22-808c-276c8a884a61","6ef2bf51-f656-49ac-843f-5954a6f2a00b","Checklist shared with leads.",6,16),T("31f972dd-c193-4c51-80e9-14900fea62f8","5868fe01-1f50-4e22-808c-276c8a884a61","288bc717-a551-4a91-8d9d-444d13addb68","Noted analytics validation.",6,18),T("7251856a-43f0-4f71-89d0-3ded9439bb26","bc98f392-ca0b-4842-8f58-2b14d3959f04","2cd5fecb-eee6-4cd1-8639-1f634b900a3b","Sent invite to executives.",6,17),T("6578e46d-5db4-45ab-899f-463f471e3729","bc98f392-ca0b-4842-8f58-2b14d3959f04","ce642ef6-6367-406e-82ea-b0236361440f","Deck updated for review.",6,19),T("66920c38-7208-4444-878a-db1f4dcf9f2b","5125d378-d1e4-4be3-8f92-df5e7115a160","ce642ef6-6367-406e-82ea-b0236361440f","Kickoff notes published.",5,9),T("0dd67bda-0d1f-40a1-85a2-a1fe8c22ee03","5125d378-d1e4-4be3-8f92-df5e7115a160","6ef2bf51-f656-49ac-843f-5954a6f2a00b","Linked recording for reference.",5,11),T("de7b5602-9d09-42f5-8cd8-9c9938229508","8808dae4-ad94-46b5-89db-46edb52efe13","288bc717-a551-4a91-8d9d-444d13addb68","Finance confirmed coverage.",5,10),T("69cc2cb7-2c6d-4f05-84f3-14bfbec37d87","8808dae4-ad94-46b5-89db-46edb52efe13","9689b595-abe1-4589-838c-1958aae53a94","Updated spreadsheet totals.",5,12),T("14e33081-6dbc-4dc7-88f6-bf41c145d8c3","0b20a227-1243-4403-8df8-db7a1db1770d","6ef2bf51-f656-49ac-843f-5954a6f2a00b","Wireframes ready for review.",7,9),T("5e118d42-c342-4bd3-8c1e-9044c5d50738","0b20a227-1243-4403-8df8-db7a1db1770d","ce642ef6-6367-406e-82ea-b0236361440f","UI feedback added.",7,11),T("037b6ba4-edb8-4612-882e-00fe45576aa2","d4e075b0-5c97-4b3f-893f-e5cced11c9f8","9689b595-abe1-4589-838c-1958aae53a94","Keyword list complete.",7,10),T("59988edf-6646-41f9-8fba-a76aaa1f9487","d4e075b0-5c97-4b3f-893f-e5cced11c9f8","288bc717-a551-4a91-8d9d-444d13addb68","Content briefs next.",7,12),T("48d3d424-25f5-4ab6-8073-396dab649803","29a6974d-db06-45ea-8edf-af9aba1ed799","ce642ef6-6367-406e-82ea-b0236361440f","Hero concept drafted.",7,13),T("4870ab00-fa52-4227-8087-8a441ad8a7e7","29a6974d-db06-45ea-8edf-af9aba1ed799","2cd5fecb-eee6-4cd1-8639-1f634b900a3b","Product copy added.",7,15),T("4666f2c7-6568-4a66-87ce-e3f75365359f","be948ffa-eb48-4a0d-850a-c6d2c36d852d","2cd5fecb-eee6-4cd1-8639-1f634b900a3b","CMS entries published.",7,14),T("418ab0e7-014a-4305-87d8-72f71cfaefae","be948ffa-eb48-4a0d-850a-c6d2c36d852d","6ef2bf51-f656-49ac-843f-5954a6f2a00b","QA will validate content.",7,16),T("d18fd8a2-453e-426c-8ae8-224eb2d5513b","dba9e06c-588a-478f-8e7f-51e3c1d6eb06","288bc717-a551-4a91-8d9d-444d13addb68","Tablet layout approved.",7,17),T("c71be2ba-9cf4-441d-8bc8-3eda3bd24b0f","dba9e06c-588a-478f-8e7f-51e3c1d6eb06","9689b595-abe1-4589-838c-1958aae53a94","Mobile tweaks needed.",7,18),T("38991ba8-f6a7-4d28-84ca-7236a64523ca","d1d6a5bd-c3b2-4faf-87f2-9068ce9f98bb","6ef2bf51-f656-49ac-843f-5954a6f2a00b","Audit checklist in progress.",7,19),T("efc10646-0497-45c6-8874-872eb28a8e5d","d1d6a5bd-c3b2-4faf-87f2-9068ce9f98bb","ce642ef6-6367-406e-82ea-b0236361440f","Color contrast updated.",7,20),T("41674b74-51b7-4aeb-89cd-a1f2096326b6","8c2240ed-194f-4a1e-8bab-0a7030ac56ce","ce642ef6-6367-406e-82ea-b0236361440f","Style guide synced to repo.",5,8),T("2d48f368-d550-48a8-85de-739f22726e03","8c2240ed-194f-4a1e-8bab-0a7030ac56ce","288bc717-a551-4a91-8d9d-444d13addb68","Design tokens verified.",5,10),T("06d66a80-910b-45b7-8849-967fece94020","f4136567-ba8b-4c4a-8128-212e159aa59f","9689b595-abe1-4589-838c-1958aae53a94","Dashboards refreshed.",5,9),T("57ce1ff5-3a51-42de-8ef7-376093a7d95c","f4136567-ba8b-4c4a-8128-212e159aa59f","2cd5fecb-eee6-4cd1-8639-1f634b900a3b","KPIs pinned for launch.",5,11)],mr=async({json:s,platform:e})=>{try{const t=e.env?.DB;if(!t){s(500,{error:"D1 binding not found. Check Cloudflare Pages configuration."});return}const n=ee(t);console.log("[Seed] Starting database seed..."),await n.delete(X),await n.delete(re),await n.delete(B),await n.delete(H),await n.delete(se),await n.delete(z),await n.delete(ye),console.log("[Seed] Cleared existing data"),await n.insert(ye).values(zt),await n.insert(z).values(St),await n.insert(se).values(xt),await n.insert(H).values(Vt);const a=5;for(let r=0;r<ut.length;r+=a){const i=ut.slice(r,r+a);await n.insert(B).values(i)}for(let r=0;r<Jt.length;r+=a){const i=Jt.slice(r,r+a);await n.insert(X).values(i)}for(let r=0;r<Wt.length;r+=a){const i=Wt.slice(r,r+a);await n.insert(re).values(i)}console.log("[Seed] Database seeded successfully"),s(200,{success:!0,message:"Database seeded successfully",data:{users:zt.length,boards:St.length,lists:xt.length,cards:ut.length,tags:Vt.length}})}catch(t){console.error("[Seed] Error:",t),s(500,{error:"Failed to seed database",details:t instanceof Error?t.message:"Unknown error"})}},br=Object.freeze(Object.defineProperty({__proto__:null,onPost:mr},Symbol.toStringTag,{value:"Module"})),pr=s=>{const e=Math.max(...s.data.map(t=>t.value),1);return o("div",null,{class:"card bg-base-100 shadow-lg"},o("div",null,{class:"card-body p-4"},[o("h3",null,{class:"card-title text-sm text-base-content mb-4"},g(t=>t.title,[s],"p0.title"),3,null),o("div",null,{class:"grid gap-4",style:g(t=>({gridTemplateColumns:`repeat(${t.data.length}, 1fr)`}),[s],"{gridTemplateColumns:`repeat(${p0.data.length}, 1fr)`}")},s.data.map((t,n)=>{const a=t.value/e*100,r=s.colors[n%s.colors.length];return o("div",null,{class:"flex flex-col items-center gap-2"},[o("div",null,{class:"w-full flex flex-col justify-end",style:{height:"150px"}},o("div",{style:{height:`${a}%`,backgroundColor:r}},{class:"w-full rounded-t"},o("div",null,{class:"text-xs text-white font-semibold text-center pt-1"},G(t,"value"),1,null),1,null),1,null),o("div",null,{class:"text-xs text-base-content text-center font-medium pt-3"},G(t,"label"),1,null)],1,t.label)}),1,null)],1,null),1,"mD_0")},gr=W(y(pr,"s_dIHOPFkq0Hg")),yr=s=>{const e=s.data.reduce((t,n)=>t+n.value,0);return o("div",null,{class:"card bg-base-100 shadow-lg"},o("div",null,{class:"card-body p-4 flex flex-col items-center"},[o("h3",null,{class:"card-title text-sm text-base-content mb-2 w-full"},g(t=>t.title,[s],"p0.title"),3,null),o("table",null,{class:"charts-css pie mx-auto mb-3",style:{height:"120px",width:"120px","--labels-size":"0"}},o("tbody",null,null,s.data.map((t,n)=>{let a=0;for(let i=0;i<n;i++)a+=s.data[i].value/e;const r=a+(e>0?t.value/e:0);return o("tr",null,null,o("td",{style:{"--start":a.toString(),"--end":r.toString(),"--color":s.colors[n%s.colors.length]}},null,null,3,null),1,t.label)}),1,null),1,null),o("div",null,{class:"flex flex-col gap-1 w-full"},s.data.map((t,n)=>{const a=e>0?t.value/e*100:0;return o("div",null,{class:"flex items-center gap-2 justify-between"},[o("div",null,{class:"flex items-center gap-2"},[o("div",{style:{backgroundColor:s.colors[n%s.colors.length]}},{class:"w-2.5 h-2.5 rounded-sm flex-shrink-0"},null,3,null),o("span",null,{class:"text-xs text-base-content"},G(t,"label"),1,null)],1,null),o("span",null,{class:"text-xs font-semibold text-base-content"},[a.toFixed(0),"%"],1,null)],1,t.label)}),1,null)],1,null),1,"jw_0")},wr=W(y(yr,"s_rTdHMmXmhpM")),vr=()=>{const[s]=_();return s.data.lists.map(e=>({label:e.title,value:e.cards.length}))},Sr=s=>{const e=["#fbbf24","#f472b6","#a78bfa","#60a5fa"],t=Ye(y(vr,"s_4x0xxUaVyiQ",[s]));return o("section",null,{class:"bg-base-200 dark:bg-base-300 shadow-xl rounded-3xl p-8 space-y-6"},[o("div",null,{class:"space-y-3"},[o("div",null,{class:"badge badge-secondary badge-outline"},"Board overview",3,null),o("h1",null,{class:"text-4xl font-black text-primary"},g(n=>n.data.title,[s],"p0.data.title"),3,null),s.data.description&&o("p",null,{class:"text-base text-base-content/60 max-w-2xl"},g(n=>n.data.description,[s],"p0.data.description"),3,"LY_0")],1,null),o("div",null,{class:"grid grid-cols-1 md:grid-cols-2 gap-12 md:gap-6 max-w-[1190px] mx-auto items-start"},[O(gr,{get data(){return t.value},colors:e,title:"Cards per List",[L]:{data:g(n=>n.value,[t],"p0.value"),title:L}},3,"LY_1"),O(wr,{get data(){return t.value},colors:e,title:"Distribution",[L]:{data:g(n=>n.value,[t],"p0.value"),title:L}},3,"LY_2")],1,null)],1,"LY_3")},xr=W(y(Sr,"s_Qj93v8ysGQM")),Ir=()=>o("svg",null,{class:"cursor-pointer",width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o("path",null,{fill:"#cccccc",d:"M13.2916 0.0012207L17.9987 4.70833L15 7.707L10.2929 2.99993L13.2916 0.0012207ZM13.2916 1.41543L11.7071 2.99993L15 6.29282L16.5845 4.70833L13.2916 1.41543ZM8.879 4.41382L13.5861 9.1209L4.70711 17.9999H0V13.2928L8.879 4.41382ZM1 13.707V16.9999H4.29289L12.1719 9.1209L8.879 5.82804L1 13.707Z"},null,3,null),3,"WQ_0"),Cr=W(y(Ir,"s_sytHft7VoYk")),Lr=()=>o("svg",null,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"w-4 h-4"},[o("line",null,{x1:"12",y1:"5",x2:"12",y2:"19"},null,3,null),o("line",null,{x1:"5",y1:"12",x2:"19",y2:"12"},null,3,null)],3,"Tv_0"),Yt=W(y(Lr,"s_wvB0FCoNqzE")),_r=({track:s})=>{const[e,t]=_();s(t.isOpen)},Nr=({track:s})=>{const[e,t]=_();s(()=>e.card.id)},Tr=s=>{const[e]=_(),t=new Set(e.value);t.has(s)?t.delete(s):t.add(s),e.value=t},Ar=()=>{const[s]=_();s.isOpen.value=!1},Qr=async s=>{const[e,t]=_();s.preventDefault();const n=s.target,a=new FormData(n),r=a.get("title"),i=a.get("description"),l=a.get("assigneeId"),d=Array.from(t.value);if(a.set("tagIds",JSON.stringify(d)),e.onUpdate){const f=e.tags.filter(u=>t.value.has(u.id));e.onUpdate({title:r,description:i||null,assigneeId:l||null,tags:f})}await e.action.submit(a),e.isOpen.value=!1},Br=async()=>{const[s]=_();confirm("Are you sure you want to delete this card?")&&(s.onDelete&&s.onDelete(s.card.id),await s.deleteAction.submit({cardId:s.card.id}),s.isOpen.value=!1)},$r=s=>{const e=K(),t=K(()=>new Set(s.card.tags.map(l=>l.id)));Ce(y(_r,"s_Ba50gpTuCtg",[e,s])),Ce(y(Nr,"s_TkEttMPHlVg",[s,t]));const n=y(Tr,"s_lVR34n9rFtM",[t]),a=y(Ar,"s_SPjmKlGUKgg",[s]),r=y(Qr,"s_2ITcnZXpzGg",[s,t]),i=y(Br,"s_JAeU4yYsj74",[s]);return O(Me,{children:o("dialog",{ref:e},{open:g(l=>l.isOpen.value,[s],"p0.isOpen.value"),class:"modal !mt-0",onClick$:me("s_xZnaOIBFy3A",[a])},[o("div",null,{class:"modal-backdrop bg-black/70"},null,3,null),o("div",null,{class:"modal-box bg-base-200 dark:bg-base-300"},o("form",null,{method:"dialog","preventdefault:submit":!0,onSubmit$:r},[o("button",null,{type:"button",class:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2",onClick$:a},"",3,null),o("h3",null,{class:"font-bold text-lg mb-4"},"Edit Card",3,null),o("input",null,{type:"hidden",name:"cardId",value:g(l=>l.card.id,[s],"p0.card.id")},null,3,null),o("div",null,{class:"form-control w-full mb-4"},[o("label",null,{class:"label"},o("span",null,{class:"label-text"},"Title",3,null),3,null),o("input",null,{type:"text",name:"title",class:"input input-bordered w-full",value:g(l=>l.card.title,[s],"p0.card.title")},null,3,null)],3,null),o("div",null,{class:"form-control w-full mb-4"},[o("label",null,{class:"label"},o("span",null,{class:"label-text"},"Description",3,null),3,null),o("textarea",null,{name:"description",class:"textarea textarea-bordered h-24 w-full",value:g(l=>l.card.description||"",[s],'p0.card.description||""')},null,3,null)],3,null),o("div",null,{class:"form-control w-full mb-4"},[o("label",null,{class:"label"},o("span",null,{class:"label-text"},"Assignee",3,null),3,null),o("select",null,{name:"assigneeId",class:"select select-bordered w-full",value:g(l=>l.card.assigneeId||"",[s],'p0.card.assigneeId||""')},[o("option",null,{value:""},"Select an assignee",3,null),s.users.map(l=>o("option",{value:G(l,"id")},null,l.name,1,l.id))],1,null)],1,null),o("div",null,{class:"form-control w-full mb-4"},[o("label",null,{class:"label"},o("span",null,{class:"label-text"},"Tags",3,null),3,null),o("div",null,{class:"flex flex-wrap gap-2 p-4 border border-base-300 rounded-lg"},s.tags.map(l=>o("button",{class:`badge border-2 font-semibold cursor-pointer transition-all hover:scale-105 ${t.value.has(l.id)?"text-white":"badge-outline"}`,style:t.value.has(l.id)?{backgroundColor:l.color,borderColor:l.color}:{color:l.color,borderColor:l.color},onClick$:me("s_zcgTH0FIXMY",[l,n])},{type:"button"},G(l,"name"),0,l.id)),1,null)],1,null),o("div",null,{class:"modal-action justify-between"},[o("button",null,{type:"button",class:"btn btn-error",disabled:g(l=>l.action.isRunning||l.deleteAction.isRunning,[s],"p0.action.isRunning||p0.deleteAction.isRunning"),onClick$:i},g(l=>l.deleteAction.isRunning?"Deleting...":"Delete Card",[s],'p0.deleteAction.isRunning?"Deleting...":"Delete Card"'),3,null),o("div",null,{class:"flex gap-2"},[o("button",null,{type:"button",class:"btn btn-ghost",onClick$:a},"Cancel",3,null),o("button",null,{type:"submit",class:"btn btn-primary",disabled:g(l=>l.action.isRunning||l.deleteAction.isRunning,[s],"p0.action.isRunning||p0.deleteAction.isRunning")},g(l=>l.action.isRunning?"Saving...":"Save Changes",[s],'p0.action.isRunning?"Saving...":"Save Changes"'),3,null)],3,null)],3,null),s.action.value?.error&&o("div",null,{class:"alert alert-error mt-4"},o("span",null,null,g(l=>l.action.value.error,[s],"p0.action.value.error"),3,null),3,"JB_0")],1,null),1,null)],1,null)},1,"JB_1")},Dr=W(y($r,"s_LlvaLW4WCsQ")),Er=({track:s})=>{const[e,t]=_();s(t.isOpen)},Or=()=>{const[s]=_();s.isOpen.value=!1},qr=async s=>{const[e,t]=_();s.preventDefault();const n=s.target,a=new FormData(n),r=a.get("userId"),i=a.get("text");e.onCommentAdd&&e.onCommentAdd({userId:r,text:i}),e.isOpen.value=!1,n.reset(),t.value=e.users[0]?.id||"",await e.action.submit(a)},Rr=s=>{const e=K(),t=K(s.users[0]?.id||"");Ce(y(Er,"s_2xREf0Nb9sM",[e,s]));const n=y(Or,"s_5l1Ct9hT3NI",[s]),a=y(qr,"s_DG6pypmf0oM",[s,t]);return O(Me,{children:o("dialog",{ref:e},{open:g(r=>r.isOpen.value,[s],"p0.isOpen.value"),class:"modal !mt-0",onClick$:me("s_3biomqAYNCg",[n])},[o("div",null,{class:"modal-backdrop bg-black/70"},null,3,null),o("div",null,{class:"modal-box bg-base-200 dark:bg-base-300 max-w-2xl"},[o("button",null,{type:"button",class:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2",onClick$:n},"",3,null),o("h3",null,{class:"font-bold text-lg mb-4"},"Comments",3,null),o("div",null,{class:"mb-6 max-h-96 overflow-y-auto"},s.card.comments.length===0?o("div",null,{class:"text-center py-8 text-base-content/60"},"No comments yet. Be the first to add one!",3,"nY_0"):o("div",null,{class:"space-y-3"},s.card.comments.map(r=>{const i=s.users.find(l=>l.id===r.userId);return o("div",null,{class:"bg-base-100 dark:bg-base-200 rounded-lg p-4"},[o("div",null,{class:"flex items-center gap-2 mb-2"},[o("span",null,{class:"font-semibold text-base-content"},i?.name||"Unknown",1,null),o("span",null,{class:"text-xs text-base-content/50"},new Date(r.createdAt).toLocaleDateString(),1,null)],1,null),o("p",null,{class:"text-sm text-base-content/80"},G(r,"text"),1,null)],1,r.id)}),1,null),1,null),o("form",null,{"preventdefault:submit":!0,onSubmit$:a},[o("input",null,{type:"hidden",name:"cardId",value:g(r=>r.card.id,[s],"p0.card.id")},null,3,null),o("div",null,{class:"form-control w-full"},[o("label",null,{class:"label"},o("span",null,{class:"label-text"},"Comment as",3,null),3,null),o("select",null,{name:"userId",class:"select select-bordered w-full",value:g(r=>r.value,[t],"p0.value"),onChange$:me("s_jukC0YPdiIU",[t])},s.users.map(r=>o("option",{value:G(r,"id")},null,r.name,1,r.id)),1,null)],1,null),o("div",null,{class:"form-control w-full mt-4"},[o("label",null,{class:"label"},o("span",null,{class:"label-text"},"Your comment",3,null),3,null),o("textarea",null,{name:"text",class:"textarea textarea-bordered h-24 w-full",placeholder:"Write your comment..."},null,3,null)],3,null),o("div",null,{class:"modal-action"},[o("button",null,{type:"button",class:"btn btn-ghost",onClick$:n},"Close",3,null),o("button",null,{type:"submit",class:"btn btn-primary",disabled:g(r=>r.action.isRunning,[s],"p0.action.isRunning")},g(r=>r.action.isRunning?"Adding...":"Add Comment",[s],'p0.action.isRunning?"Adding...":"Add Comment"'),3,null)],3,null),s.action.value?.error&&o("div",null,{class:"alert alert-error mt-4"},o("span",null,null,g(r=>r.action.value.error,[s],"p0.action.value.error"),3,null),3,"nY_1")],1,null)],1,null)],1,null)},1,"nY_2")},Fr=W(y(Rr,"s_sKyDD028RUw")),Pr=s=>{const[e]=_();s.stopPropagation(),e.value=!0},Mr=s=>{const[e]=_();s.stopPropagation(),e.value=!0},jr=s=>{const[e]=_();e.onCardUpdate&&e.onCardUpdate(e.card.id,s)},Ur=s=>{const[e]=_();e.onCardDelete&&e.onCardDelete(s)},kr=s=>{const[e]=_();if(e.onCardUpdate){const t={id:crypto.randomUUID(),userId:s.userId,text:s.text,createdAt:new Date};e.onCardUpdate(e.card.id,{comments:[...e.card.comments,t]})}},Kr=s=>{const[e]=_(),n=s.target.getAttribute("data-id");n&&(e.value=n),s.dataTransfer&&(s.dataTransfer.effectAllowed="move")},zr=s=>{Ht();const e=K(!1),t=K(!1),n=Xt(at),a=y(Pr,"s_R9dab7k7bow",[e]),r=y(Mr,"s_0StDpWdUmuk",[t]),i=y(jr,"s_HSRFbiHa6kI",[s]),l=y(Ur,"s_cgR0I6Li7Gw",[s]),d=y(kr,"s_X1JWYQQl24E",[s]);return O(Me,{children:[o("article",{onDragStart$:y(Kr,"s_VomWJvJ7XAM",[n])},{draggable:!0,"data-id":g(f=>f.card.id,[s],"p0.card.id"),class:"card bg-base-100 dark:bg-neutral shadow-lg cursor-grab active:cursor-grabbing transition-all duration-300 ease-in-out",style:g(f=>({viewTransitionName:`card-${f.card.id}`}),[s],"{viewTransitionName:`card-${p0.card.id}`}")},o("div",null,{class:"card-body gap-3 p-4"},[o("div",null,{class:"flex items-start justify-between gap-2"},[o("h3",null,{class:"card-title text-lg text-base-content"},g(f=>f.card.title,[s],"p0.card.title"),3,null),s.card.completed&&o("span",null,{class:"badge badge-success badge-outline"},"Done",3,"Hk_0"),o("button",null,{type:"button",class:"btn btn-ghost btn-xs btn-circle",onClick$:a},O(Cr,null,3,"Hk_1"),1,null)],1,null),s.card.assigneeId&&o("div",null,{class:"badge badge-outline badge-secondary badge-sm"},["Assigned to"," ",s.users?.find(f=>f.id===s.card.assigneeId)?.name??"Unassigned"],1,"Hk_2"),s.card.description&&o("p",null,{class:"text-sm text-base-content/70 bg-base-200 dark:bg-base-100 rounded-xl px-3 py-2"},g(f=>f.card.description,[s],"p0.card.description"),3,"Hk_3"),s.card.tags.length>0&&o("div",null,{class:"flex flex-wrap gap-2.5 rounded-xl px-3 py-2 bg-base-200 dark:bg-base-100"},s.card.tags.map(f=>o("span",{style:{backgroundColor:f.color}},{class:"badge border-0 shadow font-semibold text-white"},G(f,"name"),1,f.id)),1,"Hk_4"),s.card.comments.length===0?o("div",null,{class:"flex items-center justify-between"},[o("p",null,{class:"text-xs font-semibold text-base-content/50"},"Comments",3,null),o("button",null,{type:"button",class:"btn btn-ghost btn-xs btn-circle",onClick$:r},O(Yt,null,3,"Hk_5"),1,null)],1,"Hk_6"):o("div",null,{class:"rounded-2xl bg-base-200 dark:bg-base-100 p-3 space-y-2 shadow-inner relative"},[o("div",null,{class:"flex items-center justify-between"},[o("p",null,{class:"text-xs font-semibold text-base-content/50"},"Comments",3,null),o("button",null,{type:"button",class:"btn btn-ghost btn-xs btn-circle",onClick$:r},O(Yt,null,3,"Hk_7"),1,null)],1,null),o("ul",null,{class:"space-y-1 text-sm text-base-content/70"},s.card.comments.map(f=>o("li",null,null,[o("span",null,{class:"font-semibold text-base-content"},[s.users?.find(u=>u.id===f.userId)?.name??"Unknown",":"],1,null)," ",G(f,"text")],1,f.id)),1,null)],1,null)],1,null),0,null),s.updateCardAction&&s.deleteCardAction&&O(Dr,{get card(){return s.card},get users(){return s.allUsers},get tags(){return s.allTags},isOpen:e,get action(){return s.updateCardAction},get deleteAction(){return s.deleteCardAction},onUpdate:i,onDelete:l,[L]:{card:g(f=>f.card,[s],"p0.card"),users:g(f=>f.allUsers,[s],"p0.allUsers"),tags:g(f=>f.allTags,[s],"p0.allTags"),isOpen:L,action:g(f=>f.updateCardAction,[s],"p0.updateCardAction"),deleteAction:g(f=>f.deleteCardAction,[s],"p0.deleteCardAction"),onUpdate:L,onDelete:L}},3,"Hk_8"),s.createCommentAction&&O(Fr,{get card(){return s.card},get users(){return s.allUsers},isOpen:t,get action(){return s.createCommentAction},onCommentAdd:d,[L]:{card:g(f=>f.card,[s],"p0.card"),users:g(f=>f.allUsers,[s],"p0.allUsers"),isOpen:L,action:g(f=>f.createCommentAction,[s],"p0.createCommentAction"),onCommentAdd:L}},3,"Hk_9")]},1,"Hk_10")},Vr=W(y(zr,"s_LrJX2dCu9Eo")),Jr=async(s,e)=>{const[t,n,a]=_(),r=t.value;if(!r)return;e&&e.classList&&e.classList.remove("drag-over");const i=e.querySelector(".drop-zone");if(!i)return;let l=a.list.cards.length;const d=Zr(i,s.clientY);if(d){const f=d.getAttribute("data-id"),u=a.list.cards.findIndex(p=>p.id===f);u!==-1&&(l=u)}a.onCardDrop&&a.onCardDrop(r,a.list.id,l),a.moveCardAction&&await a.moveCardAction.submit({cardId:r,targetListId:a.list.id,newPosition:l}),t.value="",n.value=!1},Wr=s=>{const[e]=_();s.dataTransfer&&(s.dataTransfer.dropEffect="move"),e.value=!0},Yr=()=>{const[s]=_();s.value=!1},Hr=s=>{const e=Xt(at),t=K(!1);return o("section",null,{class:"card bg-base-200 dark:bg-base-300 min-w-[20rem] shadow-xl","preventdefault:dragover":!0,"preventdefault:drop":!0,onDragOver$:y(Wr,"s_lxy3DtRzfqE",[t]),onDragLeave$:y(Yr,"s_bctDLlHqa7M",[t]),onDrop$:y(Jr,"s_8LymbULmi4U",[e,t,s])},o("div",null,{class:"card-body gap-4"},[o("header",null,{class:"flex items-center justify-between"},[o("h2",null,{class:"card-title text-base-content"},g(i=>i.list.title,[s],"p0.list.title"),3,null),o("div",null,{class:"badge badge-primary badge-outline badge-lg shadow"},[g(i=>i.list.cards.length,[s],"p0.list.cards.length")," cards"],3,null)],3,null),o("div",null,{class:g(i=>`drop-zone min-h-[200px] transition-all duration-200 rounded-lg ${i.value?"ring-4 ring-primary ring-offset-2 bg-primary/5 scale-[1.02]":""}`,[t],'`drop-zone min-h-[200px] transition-all duration-200 rounded-lg ${p0.value?"ring-4 ring-primary ring-offset-2 bg-primary/5 scale-[1.02]":""}`')},s.list.cards.length===0?o("div",null,{class:"alert alert-info text-sm"},o("span",null,null,"No cards yet",3,null),3,"Kb_0"):o("div",null,{class:"space-y-3"},s.list.cards.map(i=>O(Vr,{card:i,get users(){return s.users},get allUsers(){return s.allUsers},get allTags(){return s.allTags},get onCardUpdate(){return s.onCardUpdate},get onCardDelete(){return s.onCardDelete},get updateCardAction(){return s.updateCardAction},get deleteCardAction(){return s.deleteCardAction},get createCommentAction(){return s.createCommentAction},[L]:{users:g(l=>l.users,[s],"p0.users"),allUsers:g(l=>l.allUsers,[s],"p0.allUsers"),allTags:g(l=>l.allTags,[s],"p0.allTags"),onCardUpdate:g(l=>l.onCardUpdate,[s],"p0.onCardUpdate"),onCardDelete:g(l=>l.onCardDelete,[s],"p0.onCardDelete"),updateCardAction:g(l=>l.updateCardAction,[s],"p0.updateCardAction"),deleteCardAction:g(l=>l.deleteCardAction,[s],"p0.deleteCardAction"),createCommentAction:g(l=>l.createCommentAction,[s],"p0.createCommentAction")}},3,i.id)),1,null),1,null)],1,null),1,"Kb_1")},Xr=W(y(Hr,"s_Dy0wwDaxc0o"));function Zr(s,e){return Array.from(s.querySelectorAll("[data-id]:not(.dragging)")).reduce((n,a)=>{const r=a.getBoundingClientRect(),i=e-r.top-r.height/2;return i<0&&i>n.offset?{offset:i,element:a}:n},{offset:Number.NEGATIVE_INFINITY,element:null}).element}const Gr=({track:s})=>{const[e,t]=_();s(t.isOpen)},ei=s=>{const[e]=_(),t=new Set(e.value);t.has(s)?t.delete(s):t.add(s),e.value=t},ti=()=>{const[s,e]=_();s.isOpen.value=!1,e.value=new Set},si=async s=>{const[e,t]=_(),n=s.target,a=new FormData(n),r=a.get("title"),i=a.get("description"),l=a.get("assigneeId"),d=Array.from(t.value);a.set("tagIds",JSON.stringify(d));const f=await e.action.submit(a);f.value?.success&&f.value.cardId&&e.onCardAdd&&(e.onCardAdd({id:f.value.cardId,title:r,description:i||null,assigneeId:l||null,tagIds:d}),e.isOpen.value=!1,n.reset(),t.value=new Set)},ni=s=>{const e=K(),t=K(new Set);Ce(y(Gr,"s_qrCCmzDo6R4",[e,s]));const n=y(ei,"s_YoOajcnI2rM",[t]),a=y(ti,"s_AKZ8wD0K65I",[s,t]),r=y(si,"s_2x5c3AfBiuM",[s,t]);return O(Me,{children:o("dialog",{ref:e},{open:g(i=>i.isOpen.value,[s],"p0.isOpen.value"),class:"modal !mt-0",onClick$:me("s_OXM9xtpDyAI",[a])},[o("div",null,{class:"modal-backdrop bg-black/70"},null,3,null),o("div",null,{class:"modal-box bg-base-200 dark:bg-base-300"},o("form",null,{method:"dialog","preventdefault:submit":!0,onSubmit$:r},[o("button",null,{type:"button",class:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2",onClick$:a},"",3,null),o("h3",null,{class:"font-bold text-lg mb-4"},"Add New Card",3,null),o("input",null,{type:"hidden",name:"boardId",value:g(i=>i.boardId,[s],"p0.boardId")},null,3,null),o("div",null,{class:"form-control w-full mb-4"},[o("label",null,{class:"label"},o("span",null,{class:"label-text"},"Title",3,null),3,null),o("input",null,{type:"text",name:"title",class:"input input-bordered w-full",placeholder:"Enter card title"},null,3,null)],3,null),o("div",null,{class:"form-control w-full mb-4"},[o("label",null,{class:"label"},o("span",null,{class:"label-text"},"Description",3,null),3,null),o("textarea",null,{name:"description",class:"textarea textarea-bordered h-24 w-full",placeholder:"Enter card description (optional)"},null,3,null)],3,null),o("div",null,{class:"form-control w-full mb-4"},[o("label",null,{class:"label"},o("span",null,{class:"label-text"},"Assignee",3,null),3,null),o("select",null,{name:"assigneeId",class:"select select-bordered w-full"},[o("option",null,{value:""},"Select an assignee",3,null),s.users.map(i=>o("option",{value:G(i,"id")},null,i.name,1,i.id))],1,null)],1,null),o("div",null,{class:"form-control w-full mb-4"},[o("label",null,{class:"label"},o("span",null,{class:"label-text"},"Tags",3,null),3,null),o("div",null,{class:"flex flex-wrap gap-2 p-4 border border-base-300 rounded-lg"},s.tags.map(i=>o("button",{class:`badge border-2 font-semibold cursor-pointer transition-all hover:scale-105 ${t.value.has(i.id)?"text-white":"badge-outline"}`,style:t.value.has(i.id)?{backgroundColor:i.color,borderColor:i.color}:{color:i.color,borderColor:i.color},onClick$:me("s_E1q9RiBNHpI",[i,n])},{type:"button"},G(i,"name"),0,i.id)),1,null)],1,null),o("div",null,{class:"modal-action"},[o("button",null,{type:"button",class:"btn btn-ghost",onClick$:a},"Cancel",3,null),o("button",null,{type:"submit",class:"btn btn-primary",disabled:g(i=>i.action.isRunning,[s],"p0.action.isRunning")},g(i=>i.action.isRunning?"Creating...":"Add Card",[s],'p0.action.isRunning?"Creating...":"Add Card"'),3,null)],3,null),s.action.value?.error&&o("div",null,{class:"alert alert-error mt-4"},o("span",null,null,g(i=>i.action.value.error,[s],"p0.action.value.error"),3,null),3,"e3_0")],1,null),1,null)],1,null)},1,"e3_1")},ai=W(y(ni,"s_lBedyPiPiZg")),at=Ns("dragged-card"),ri=async({params:s,platform:e})=>{const t=e.env?.DB,n=s.id;return await Ea(t,n)},$t=tt(y(ri,"s_rmdas0hQpmk")),ii=async({platform:s})=>{const e=s.env?.DB;return await Oa(e)},ps=tt(y(ii,"s_HynAK3XzDMM")),li=async({platform:s})=>{const e=s.env?.DB;return await qa(e)},gs=tt(y(li,"s_W1ZQJC5S70w")),oi=async(s,{params:e,platform:t})=>{try{const n=t.env?.DB,a=ee(n);let r=[];if(s.tagIds)try{r=typeof s.tagIds=="string"?JSON.parse(s.tagIds):s.tagIds}catch(x){console.error("Failed to parse tagIds:",x)}const i=$e(Xa,{title:s.title,description:s.description||null,assigneeId:s.assigneeId,tagIds:r.length>0?r:void 0});if(!i.success)return{success:!1,error:i.issues[0]?.message??"Invalid card data"};const l=i.output,d=e.id,u=(await a.select().from(se).where(Z(se.boardId,d))).find(x=>x.title==="Todo");if(!u)return{success:!1,error:"Todo list not found for this board"};const v=((await a.select({maxPos:xn(B.position)}).from(B).where(Z(B.listId,u.id)))[0]?.maxPos??-1)+1,S=crypto.randomUUID();return await a.insert(B).values({id:S,listId:u.id,title:l.title,description:l.description??null,assigneeId:l.assigneeId,position:v,completed:!1}),l.tagIds&&l.tagIds.length>0&&await a.insert(X).values(l.tagIds.map(x=>({cardId:S,tagId:x}))),{success:!0,cardId:S}}catch(n){return console.error("Failed to create card:",n),{success:!1,error:n instanceof Error?n.message:"Failed to create card. Please try again."}}},ys=be(y(oi,"s_TMKkdwao0Rg")),ci=async(s,{platform:e})=>{try{const t=e.env?.DB,n=ee(t);let a=[];if(s.tagIds)try{a=typeof s.tagIds=="string"?JSON.parse(s.tagIds):s.tagIds}catch(l){console.error("Failed to parse tagIds:",l)}const r=$e(Za,{cardId:s.cardId,title:s.title,description:s.description||null,assigneeId:s.assigneeId,tagIds:a.length>0?a:void 0});if(!r.success)return{success:!1,error:r.issues[0]?.message??"Invalid card data"};const i=r.output;return await n.update(B).set({title:i.title,description:i.description??null,assigneeId:i.assigneeId}).where(Z(B.id,i.cardId)),await n.delete(X).where(Z(X.cardId,i.cardId)),i.tagIds&&i.tagIds.length>0&&await n.insert(X).values(i.tagIds.map(l=>({cardId:i.cardId,tagId:l}))),{success:!0}}catch(t){return console.error("Failed to update card:",t),{success:!1,error:t instanceof Error?t.message:"Failed to update card. Please try again."}}},ws=be(y(ci,"s_0VmVLFQWTRA")),di=async(s,{platform:e})=>{try{const t=e.env?.DB,n=ee(t),a=s.cardId;return a?(await n.delete(B).where(Z(B.id,a)),{success:!0}):{success:!1,error:"Card ID is required"}}catch(t){return console.error("Failed to delete card:",t),{success:!1,error:t instanceof Error?t.message:"Failed to delete card. Please try again."}}},vs=be(y(di,"s_4h8Bbb0sqdw")),ui=async(s,{platform:e})=>{try{const t=e.env?.DB,n=ee(t),a=$e(fs,s);if(!a.success)return{success:!1,error:a.issues[0]?.message??"Invalid move payload"};const r=a.output;return await n.update(B).set({listId:r.listId}).where(Z(B.id,r.cardId)),{success:!0}}catch(t){return console.error("Failed to update card list:",t),{success:!1,error:t instanceof Error?t.message:"Failed to move card. Please try again."}}},fi=be(y(ui,"s_Rr1Ho5f6gbQ")),hi=async(s,{platform:e})=>{try{const t=e.env?.DB,n=ee(t),a=$e(er,s);if(!a.success)return{success:!1,error:a.issues[0]?.message??"Invalid position payload"};const r=a.output;return await n.update(B).set({position:r.position}).where(Z(B.id,r.cardId)),{success:!0}}catch(t){return console.error("Failed to update card position:",t),{success:!1,error:t instanceof Error?t.message:"Failed to reorder card. Please try again."}}},mi=be(y(hi,"s_JEnbvZkDtf4")),bi=async(s,{request:e,platform:t})=>{try{const n=t.env?.DB,a=ee(n),r=await e.formData(),i=r.get("cardId"),l=JSON.parse(r.get("tagIds")||"[]");return i?(await a.delete(X).where(Z(X.cardId,i)),l&&l.length>0&&await a.insert(X).values(l.map(d=>({cardId:i,tagId:d}))),{success:!0}):{success:!1,error:"Card ID is required"}}catch(n){return console.error("Failed to update card tags:",n),{success:!1,error:n instanceof Error?n.message:"Failed to update tags. Please try again."}}},pi=be(y(bi,"s_WltWbdJvgso")),gi=async(s,{platform:e})=>{try{const t=e.env?.DB,n=ee(t),a=$e(Ga,{cardId:s.cardId,userId:s.userId,text:s.text});if(!a.success)return{success:!1,error:a.issues[0]?.message??"Invalid comment data"};const r=a.output,i=crypto.randomUUID();return await n.insert(re).values({id:i,cardId:r.cardId,userId:r.userId,text:r.text}),{success:!0,commentId:i}}catch(t){return console.error("Failed to create comment:",t),{success:!1,error:t instanceof Error?t.message:"Failed to add comment. Please try again."}}},Ss=be(y(gi,"s_KAjtzCPVfFI")),yi=async(s,{platform:e})=>{try{const t=e.env?.DB;let n,a,r;s instanceof FormData?(n=s.get("cardId"),a=s.get("targetListId"),r=parseInt(s.get("newPosition"),10)):(n=s.cardId,a=s.targetListId,r=s.newPosition);const i=$e(fs,{cardId:n,listId:a,newPosition:r});if(!i.success)return{success:!1,error:i.issues[0]?.message??"Invalid move payload"};const l=i.output,{updateCardListAndPosition:d}=await import("./q-LE5HwU-U.js");return await d(t,l.cardId,l.listId,l.newPosition),{success:!0}}catch(t){return console.error("Failed to move card:",t),{success:!1,error:t instanceof Error?t.message:"Failed to move card. Please try again."}}},xs=be(y(yi,"s_psEL7Q5zoQA")),wi=({track:s})=>{const[e,t]=_(),n=s(e);n&&(t.value=n)},vi=()=>{const[s,e]=_();return e.value||s.value},Si=()=>{const[s]=_();return(s.value?.lists??[]).map(t=>({id:t.id,count:t.cards.length}))},xi=(s,e)=>{const[t]=_();if(!t.value)return;const n={...t.value,lists:t.value.lists.map(a=>({...a,cards:a.cards.map(r=>r.id===s?{...r,...e}:r)}))};t.value=n},Ii=s=>{const[e,t]=_();if(!e.value)return;const n=e.value.lists.find(l=>l.title==="Todo");if(!n||e.value.lists.some(l=>l.cards.some(d=>d.id===s.id)))return;const r={id:s.id,title:s.title,description:s.description,assigneeId:s.assigneeId,position:n.cards.length,completed:!1,tags:t.value.filter(l=>s.tagIds.includes(l.id)),comments:[]},i={...e.value,lists:e.value.lists.map(l=>l.title==="Todo"?{...l,cards:[...l.cards,r]}:l)};e.value=i},Ci=s=>{const[e]=_();if(!e.value)return;const t={...e.value,lists:e.value.lists.map(n=>({...n,cards:n.cards.filter(a=>a.id!==s)}))};e.value=t},Li=(s,e,t)=>{const[n]=_();if(!n.value)return;const a=n.value.lists.map(d=>({...d,cards:d.cards.filter(f=>f.id!==s)})),r=a.findIndex(d=>d.id===e);if(r===-1)return;const i=n.value.lists.flatMap(d=>d.cards).find(d=>d.id===s);if(!i)return;const l=a[r].cards.slice(0,t).concat({...i,position:t}).concat(a[r].cards.slice(t).map((d,f)=>({...d,position:t+1+f})));a[r]={...a[r],cards:l},n.value={...n.value,lists:a}},_i=()=>{Ht();const s=$t(),e=ps(),t=gs(),n=xs(),a=ys(),r=ws(),i=vs(),l=Ss(),d=K(s.value),f=K(!1),u=K("");Ts(at,u),Ce(y(wi,"s_FBnud9VMJxs",[s,d]));const p=Ye(y(vi,"s_wH4PNPIBhS0",[s,d])),v=Ye(y(Si,"s_wNKbA8IFjEo",[p])),S=y(xi,"s_mLNFyvQvbJU",[d]),x=y(Ii,"s_HNK30AFj8rg",[d,t]),C=y(Ci,"s_9tAitcOEbsU",[d]),D=y(Li,"s_F2LmZcLCNzg",[d]);return s.value?o("main",null,{class:"w-full p-8 space-y-10 rounded-3xl bg-base-100 dark:bg-base-200 shadow-xl"},[o("div",null,{class:"breadcrumbs text-sm"},o("ul",null,null,[o("li",null,null,O(ft,{href:"/",class:"link link-hover",children:"Boards",[L]:{href:L,class:L}},3,"LD_2"),1,null),o("li",null,null,o("span",null,{class:"text-base-content/60"},g(N=>N.value.title,[s],"p0.value.title"),3,null),3,null)],1,null),1,null),o("div",null,{class:"space-y-8"},[p.value&&O(xr,{get data(){return p.value},[L]:{data:g(N=>N.value,[p],"p0.value")}},3,JSON.stringify(v.value)),o("div",null,{class:"flex justify-start mb-4"},o("button",null,{type:"button",class:"btn btn-primary",onClick$:me("s_ynu9tZC6jQw",[f])},"Add Card",3,null),3,null),o("section",null,{class:"flex gap-7 overflow-x-auto pb-8"},!d.value||d.value.lists.length===0?o("div",null,{class:"card bg-base-200 dark:bg-base-300 shadow-xl w-full max-w-md mx-auto"},o("div",null,{class:"card-body items-center text-center"},[o("h2",null,{class:"card-title text-secondary"},"No lists yet",3,null),o("p",null,{class:"text-base-content/60"},"Add a list to begin organizing work on this board.",3,null)],3,null),3,"LD_3"):d.value.lists.map(N=>O(Xr,{list:N,get users(){return e.value},get allUsers(){return e.value},get allTags(){return t.value},onCardUpdate:S,onCardDelete:C,onCardDrop:D,updateCardAction:r,deleteCardAction:i,createCommentAction:l,moveCardAction:n,[L]:{users:g(R=>R.value,[e],"p0.value"),allUsers:g(R=>R.value,[e],"p0.value"),allTags:g(R=>R.value,[t],"p0.value"),onCardUpdate:L,onCardDelete:L,onCardDrop:L,updateCardAction:L,deleteCardAction:L,createCommentAction:L,moveCardAction:L}},3,N.id)),1,null)],1,null),O(ai,{get boardId(){return s.value.id},get users(){return e.value},get tags(){return t.value},isOpen:f,action:a,onCardAdd:x,[L]:{boardId:g(N=>N.value.id,[s],"p0.value.id"),users:g(N=>N.value,[e],"p0.value"),tags:g(N=>N.value,[t],"p0.value"),isOpen:L,action:L,onCardAdd:L}},3,"LD_4")],1,"LD_5"):o("main",null,{class:"w-full max-w-4xl mx-auto p-8 space-y-10 rounded-3xl bg-base-100 dark:bg-base-200 shadow-xl"},o("div",null,{class:"text-center space-y-4"},[o("h1",null,{class:"text-3xl font-bold text-error"},"Board Not Found",3,null),o("p",null,{class:"text-base-content/60"},"The board you're looking for doesn't exist.",3,null),O(ft,{href:"/",class:"btn btn-primary",children:"Back to Boards",[L]:{href:L,class:L}},3,"LD_0")],1,null),1,"LD_1")},Ni=W(y(_i,"s_Y0M1n1aDdW4")),Ti=({resolveValue:s})=>{const e=s($t);return{title:e?`${e.title} - Kanban Board`:"Board Not Found",meta:[{name:"description",content:e?.description||"View and manage your Kanban board"}]}},Ai=Object.freeze(Object.defineProperty({__proto__:null,DraggedCardContext:at,default:Ni,head:Ti,useBoardData:$t,useCreateCardAction:ys,useCreateCommentAction:Ss,useDeleteCardAction:vs,useMoveCardAction:xs,useTagsData:gs,useUpdateCardAction:ws,useUpdateCardListAction:fi,useUpdateCardPositionAction:mi,useUpdateCardTagsAction:pi,useUsersData:ps},Symbol.toStringTag,{value:"Module"})),Qi=[],Ve=()=>Bs,Bi=[["/",[Ve,()=>cr],"/",["q-6pXyi-_v.js","q-BQNaVYR-.js"]],["api/migrate/",[Ve,()=>ur],"/api/migrate/",["q-6pXyi-_v.js"]],["api/seed/",[Ve,()=>br],"/api/seed/",["q-6pXyi-_v.js"]],["board/[id]/",[Ve,()=>Ai],"/board/[id]/",["q-6pXyi-_v.js","q-DvKqeB6O.js"]]],$i=[],Di=!0,Ei="/",Oi=!0,Pi={routes:Bi,serverPlugins:Qi,menus:$i,trailingSlash:Di,basePathname:Ei,cacheModules:Oi};export{pt as a,Zs as b,B as c,en as d,Z as e,Qi as f,ee as g,Ei as h,Oi as i,Gs as l,$i as m,Pi as q,Bi as r,c as s,Di as t};

---
import { getBoards } from "../lib/api";
import htmxUrl from "../assets/js/htmx.min.js?url";
import BoardsList from "../components/BoardsList.astro";
import AddBoardModal from "../components/modals/AddBoardModal.astro";
import "../assets/app.css";

const boards = await getBoards();
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0"
    />
    <title>Kanban Board</title>
    <script src={htmxUrl}></script>
    <script>
      import { handleAddBoardResponse } from "../lib/modal-handlers";

      // Initialize namespace
      window.kanban = window.kanban || {};

      // Expose handlers to window namespace
      window.kanban.handleAddBoardResponse = handleAddBoardResponse;
    </script>
  </head>
  <body>
    <div class="min-h-screen bg-base-300 text-base-content p-4 md:p-8">
      <main
        class="w-full max-w-4xl mx-auto p-8 space-y-10 rounded-[2.5rem] bg-base-100 dark:bg-base-200 shadow-xl"
      >
        <header class="text-center space-y-3">
          <p class="text-sm uppercase tracking-wide text-secondary">
            Your workspace
          </p>
          <h1 class="text-4xl font-black text-primary">Boards</h1>
          <p class="text-base text-base-content/60">
            Choose a board to jump into your Kanban flow.
          </p>
        </header>

        <div class="flex justify-end">
          <button
            type="button"
            class="btn btn-primary"
            onclick="document.getElementById('add-board-modal').showModal()"
          >
            Add Board
          </button>
        </div>

        <BoardsList boards={boards} />
      </main>

      <AddBoardModal />
    </div>
  </body>
</html>
